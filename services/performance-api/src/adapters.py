from collections import namedtuple
from collections import namedtuple
from dataclasses import asdict
from datetime import date
from decimal import Decimal
from typing import List

import boto3
# import psycopg2
from boto3.dynamodb.conditions import Key
from yahooquery import Ticker

from goatcommons.models import Investment
from goatcommons.utils import InvestmentUtils
from models import Portfolio

# logging.basicConfig(level=logging.DEBUG)

IntraDayData = namedtuple('IntraDayData', 'price prev_close_price change name')
MonthData = namedtuple('MonthlyData', 'date open close change')


class MarketData:
    """
        MarketData its responsible to join information from MarketStack and YahooFinance API's
        market stack has a great api, but only have info until yesterday (D-1)
        yahoo finance has both now and historical data, but the historical data for some tickers are not reliable
    """

    def __init__(self):
        self.yahoo_ticker = None
        self.history_cache = {}
        # self.con = psycopg2.connect(host='localhost', database='postgres',
        #                             user='postgres', password='postgres')

    def ticker_intraday_date(self, ticker: str):
        if self.yahoo_ticker is None:
            self.yahoo_ticker = Ticker(f'{ticker}.SA')
        else:
            self.yahoo_ticker.symbols = f'{ticker}.SA'
        result = self.yahoo_ticker.price[f'{ticker}.SA']
        return IntraDayData(Decimal(result['regularMarketPrice']).quantize(Decimal('0.01')),
                            Decimal(result['regularMarketPreviousClose']).quantize(Decimal('0.01')),
                            Decimal(result['regularMarketChangePercent']).quantize(Decimal('0.01')),
                            result['shortName'])

    def ticker_monthly_data(self, ticker, date_from=None):
        if ticker in self.history_cache:
            return self.history_cache[ticker]

        cursor = self.con.cursor()
        cursor.execute(
            f'SELECT candle_date, open_price, close_price from b3_monthly_chart where ticker = \'{ticker}\' order by candle_date')
        result = [MonthData(*c, 0.0) for c in cursor.fetchall()]
        # print(result)
        self.history_cache[ticker] = result

        return result

    def ticker_month_data(self, ticker, _date):
        """
            Gets candle(open, close) for the entire date.year/date.month
        """
        data = self.ticker_monthly_data(ticker)
        date_from = date(_date.year, _date.month, 1)

        return list(filter(lambda m: m.date == date_from, data))[0]


class InvestmentRepository:
    def __init__(self):
        self.__investments_table = boto3.resource('dynamodb').Table('Investments')

    def find_by_subject(self, subject) -> List[Investment]:
        result = self.__investments_table.query(KeyConditionExpression=Key('subject').eq(subject))
        print(f'RESULT: {result}')
        return list(map(lambda i: InvestmentUtils.load_model_by_type(i['type'], i), result['Items']))

    def find_by_subject_mocked(self, subject) -> List[Investment]:
        result = {'Items': [
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1555297200'),
             'operation': 'BUY', 'ticker': 'KNRI11', 'costs': Decimal('0'), 'amount': Decimal('3'),
             'price': Decimal('152.78'), 'external_system': '', 'id': '00bd21e4-670d-4841-a108-156a2b9e5426',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1533610800'),
             'operation': 'BUY', 'ticker': 'HGBS11', 'costs': Decimal('0'), 'amount': Decimal('7'),
             'price': Decimal('200.5'), 'external_system': '', 'id': '079d1cea-8812-473f-b61f-f944bcc69b01',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'CLEAR', 'date': Decimal('1560481200'),
             'operation': 'BUY', 'ticker': 'FLRY3', 'costs': Decimal('0'), 'amount': Decimal('31'),
             'price': Decimal('21.04'), 'external_system': '', 'id': '19b53ab3-48ba-42c9-b921-350e926c5522',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1556593200'),
             'operation': 'BUY', 'ticker': 'FLRY3', 'costs': Decimal('0'), 'amount': Decimal('100'),
             'price': Decimal('20.81'), 'external_system': '', 'id': '1a564397-b69f-428b-ad21-b7569bf32318',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1557111600'),
             'operation': 'SELL', 'ticker': 'ECOR3', 'costs': Decimal('0'), 'amount': Decimal('100'),
             'price': Decimal('8.41'), 'external_system': '', 'id': '20ce0493-c4ef-4d28-8014-5b9be1efa753',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1555297200'),
             'operation': 'BUY', 'ticker': 'TIET11', 'costs': Decimal('0'), 'amount': Decimal('300'),
             'price': Decimal('10.8'), 'external_system': '', 'id': '2bc11f93-745f-4df8-a2be-feb1fb021c62',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'CLEAR', 'date': Decimal('1559271600'),
             'operation': 'BUY', 'ticker': 'WEGE3', 'costs': Decimal('0'), 'amount': Decimal('1'),
             'price': Decimal('19.08'), 'external_system': '', 'id': '39607140-f265-4bc3-aec9-19d1a48c679b',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1553482800'),
             'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'), 'amount': Decimal('100'),
             'price': Decimal('12.04'), 'external_system': '', 'id': '412e000c-e6f1-44bb-a8e7-a8ccd0aa7866',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1553482800'),
             'operation': 'BUY', 'ticker': 'FLRY3', 'costs': Decimal('0'), 'amount': Decimal('100'),
             'price': Decimal('19.9'), 'external_system': '', 'id': '4f3ab1ee-9111-464f-bf2f-d79a16eeb250',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'CLEAR', 'date': Decimal('1563159600'),
             'operation': 'BUY', 'ticker': 'MDIA3', 'costs': Decimal('0'), 'amount': Decimal('57'),
             'price': Decimal('39.11'), 'external_system': '', 'id': '589dae4c-acfe-4a06-8a33-79ac57ea8fa4',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1556593200'),
             'operation': 'BUY', 'ticker': 'ECOR3', 'costs': Decimal('0'), 'amount': Decimal('100'),
             'price': Decimal('8.08'), 'external_system': '', 'id': '6069c17b-f97e-4c4c-b59a-7bc81eba1cba',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1554778800'),
             'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'), 'amount': Decimal('100'),
             'price': Decimal('11.85'), 'external_system': '', 'id': '6b31cf38-ecd5-48aa-a743-94002b59dfa3',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1556593200'),
             'operation': 'BUY', 'ticker': 'KNRI11', 'costs': Decimal('0'), 'amount': Decimal('4'),
             'price': Decimal('150.55'), 'external_system': '', 'id': '6c8ead40-6f04-4bfe-ac78-5e1654c5137e',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1555297200'),
             'operation': 'BUY', 'ticker': 'BRCR11', 'costs': Decimal('0'), 'amount': Decimal('1'),
             'price': Decimal('93.43'), 'external_system': '', 'id': '6d3f1a82-ce3c-455e-ab7a-85a427d4d73a',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'CLEAR', 'date': Decimal('1559271600'),
             'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'), 'amount': Decimal('11'),
             'price': Decimal('38.8'), 'external_system': '', 'id': '77703904-361e-4438-b01e-b5c5146b8b28',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '', 'date': Decimal('1557111600'),
             'operation': 'BUY', 'ticker': 'HGBS11', 'costs': Decimal('0'), 'amount': Decimal('3'),
             'price': Decimal('252.48'), 'external_system': '', 'id': '7f8efabb-5e5a-4c7a-ac0a-50b7970303b3',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1553828400'),
             'operation': 'BUY', 'ticker': 'HGBS11', 'costs': Decimal('0'), 'amount': Decimal('1'),
             'price': Decimal('253.8'), 'external_system': '', 'id': '80c2f0b8-4abf-4635-a95a-bbd3e0cea850',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1554778800'),
             'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'), 'amount': Decimal('90'),
             'price': Decimal('11.88'), 'external_system': '', 'id': '82cd627a-aa75-4394-90cb-b08ef0ce9aca',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'CLEAR', 'date': Decimal('1560481200'),
             'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'), 'amount': Decimal('2'),
             'price': Decimal('37.65'), 'external_system': '', 'id': '9c261cf8-b184-47ad-838f-67415a4e3206',
             'type': 'STOCK'}, {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
                                'date': Decimal('1589932800'), 'operation': 'BUY', 'ticker': 'ALZR11',
                                'costs': Decimal('0'), 'amount': Decimal('16'), 'price': Decimal('107.9'),
                                'external_system': 'CEI', 'id': 'CEIALZR11158993280016107901', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1589932800'), 'operation': 'BUY', 'ticker': 'ALZR11', 'costs': Decimal('0'),
             'amount': Decimal('4'), 'price': Decimal('107.9'), 'external_system': 'CEI',
             'id': 'CEIALZR1115899328004107901', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1580342400'), 'operation': 'BUY', 'ticker': 'ARZZ3', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('61.68'), 'external_system': 'CEI',
             'id': 'CEIARZZ315803424001061681', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1604880000'), 'operation': 'SELL', 'ticker': 'ARZZ3', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('64.18'), 'external_system': 'CEI',
             'id': 'CEIARZZ316048800001064181', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1584316800'), 'operation': 'BUY', 'ticker': 'AZUL4', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('17.5'), 'external_system': 'CEI',
             'id': 'CEIAZUL4158431680010017501', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1595289600'), 'operation': 'SELL', 'ticker': 'AZUL4', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('21.92'), 'external_system': 'CEI',
             'id': 'CEIAZUL4159528960010021921', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1613952000'), 'operation': 'BUY', 'ticker': 'BBAS3', 'costs': Decimal('0'),
             'amount': Decimal('200'), 'price': Decimal('29.01'), 'external_system': 'CEI',
             'id': 'CEIBBAS3161395200020029011', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1589932800'), 'operation': 'BUY', 'ticker': 'BCFF11', 'costs': Decimal('0'),
             'amount': Decimal('12'), 'price': Decimal('84.4'), 'external_system': 'CEI',
             'id': 'CEIBCFF1115899328001284401', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1602201600'), 'operation': 'BUY', 'ticker': 'BCFF11', 'costs': Decimal('0'),
             'amount': Decimal('2'), 'price': Decimal('90.57'), 'external_system': 'CEI',
             'id': 'CEIBCFF111602201600290571', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1602201600'), 'operation': 'BUY', 'ticker': 'BCFF11', 'costs': Decimal('0'),
             'amount': Decimal('3'), 'price': Decimal('90.57'), 'external_system': 'CEI',
             'id': 'CEIBCFF111602201600390571', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1602201600'), 'operation': 'BUY', 'ticker': 'BCFF11', 'costs': Decimal('0'),
             'amount': Decimal('4'), 'price': Decimal('90.57'), 'external_system': 'CEI',
             'id': 'CEIBCFF111602201600490571', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1602201600'), 'operation': 'BUY', 'ticker': 'BCFF11', 'costs': Decimal('0'),
             'amount': Decimal('4'), 'price': Decimal('90.57'), 'external_system': 'CEI',
             'id': 'CEIBCFF111602201600490572', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1602201600'), 'operation': 'BUY', 'ticker': 'BCFF11', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('90.57'), 'external_system': 'CEI',
             'id': 'CEIBCFF111602201600590571', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1602201600'), 'operation': 'BUY', 'ticker': 'BCFF11', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('90.57'), 'external_system': 'CEI',
             'id': 'CEIBCFF111602201600590572', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1567382400'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('60.33'), 'external_system': 'CEI',
             'id': 'CEIBIDI1115673824001060331', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1567987200'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('55.49'), 'external_system': 'CEI',
             'id': 'CEIBIDI111567987200555491', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1568764800'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('57.86'), 'external_system': 'CEI',
             'id': 'CEIBIDI111568764800557861', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1568764800'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('57.9'), 'external_system': 'CEI',
             'id': 'CEIBIDI111568764800557901', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1569369600'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('56.3'), 'external_system': 'CEI',
             'id': 'CEIBIDI1115693696001056301', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1569974400'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('20'), 'price': Decimal('51.4'), 'external_system': 'CEI',
             'id': 'CEIBIDI1115699744002051401', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1570665600'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('46.58'), 'external_system': 'CEI',
             'id': 'CEIBIDI111570665600546581', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1582675200'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('44.2'), 'external_system': 'CEI',
             'id': 'CEIBIDI1115826752001044201', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583452800'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('1'), 'price': Decimal('39'), 'external_system': 'CEI',
             'id': 'CEIBIDI111583452800139001', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583452800'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('4'), 'price': Decimal('39'), 'external_system': 'CEI',
             'id': 'CEIBIDI111583452800439001', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583452800'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('39'), 'external_system': 'CEI',
             'id': 'CEIBIDI111583452800539001', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583712000'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('15'), 'price': Decimal('31.6'), 'external_system': 'CEI',
             'id': 'CEIBIDI1115837120001531601', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583884800'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('4'), 'price': Decimal('29.4'), 'external_system': 'CEI',
             'id': 'CEIBIDI111583884800429401', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583884800'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('7'), 'price': Decimal('29.4'), 'external_system': 'CEI',
             'id': 'CEIBIDI111583884800729401', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583971200'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('23.4'), 'external_system': 'CEI',
             'id': 'CEIBIDI1115839712001023401', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583971200'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('25'), 'external_system': 'CEI',
             'id': 'CEIBIDI111583971200525001', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583971200'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('25'), 'external_system': 'CEI',
             'id': 'CEIBIDI111583971200525002', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1587686400'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('25.96'), 'external_system': 'CEI',
             'id': 'CEIBIDI11158768640010025961', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1600646400'), 'operation': 'BUY', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('25'), 'price': Decimal('51.5'), 'external_system': 'CEI',
             'id': 'CEIBIDI1116006464002551501', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1604880000'), 'operation': 'SELL', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('40'), 'price': Decimal('60.06'), 'external_system': 'CEI',
             'id': 'CEIBIDI1116048800004060061', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1614902400'), 'operation': 'SELL', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('22'), 'price': Decimal('160.5'), 'external_system': 'CEI',
             'id': 'CEIBIDI11161490240022160501', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1614902400'), 'operation': 'SELL', 'ticker': 'BIDI11', 'costs': Decimal('0'),
             'amount': Decimal('7'), 'price': Decimal('160.5'), 'external_system': 'CEI',
             'id': 'CEIBIDI1116149024007160501', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1982 - MODAL DTVM LTDA',
             'date': Decimal('1565913600'), 'operation': 'SELL', 'ticker': 'BRCR11', 'costs': Decimal('0'),
             'amount': Decimal('2'), 'price': Decimal('96.47'), 'external_system': 'CEI',
             'id': 'CEIBRCR111565913600296471', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1982 - MODAL DTVM LTDA',
             'date': Decimal('1565913600'), 'operation': 'SELL', 'ticker': 'BRCR11', 'costs': Decimal('0'),
             'amount': Decimal('7'), 'price': Decimal('96.41'), 'external_system': 'CEI',
             'id': 'CEIBRCR111565913600796411', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1982 - MODAL DTVM LTDA',
             'date': Decimal('1572220800'), 'operation': 'SELL', 'ticker': 'CEAB3', 'costs': Decimal('0'),
             'amount': Decimal('300'), 'price': Decimal('17.33'), 'external_system': 'CEI',
             'id': 'CEICEAB3157222080030017331', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1982 - MODAL DTVM LTDA',
             'date': Decimal('1572220800'), 'operation': 'SELL', 'ticker': 'CEAB3', 'costs': Decimal('0'),
             'amount': Decimal('35'), 'price': Decimal('17.23'), 'external_system': 'CEI',
             'id': 'CEICEAB315722208003517231', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1566345600'), 'operation': 'BUY', 'ticker': 'EMBR3', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('17.89'), 'external_system': 'CEI',
             'id': 'CEIEMBR3156634560010017891', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1567987200'), 'operation': 'BUY', 'ticker': 'EMBR3', 'costs': Decimal('0'),
             'amount': Decimal('21'), 'price': Decimal('18.35'), 'external_system': 'CEI',
             'id': 'CEIEMBR315679872002118351', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1569369600'), 'operation': 'BUY', 'ticker': 'EMBR3', 'costs': Decimal('0'),
             'amount': Decimal('50'), 'price': Decimal('18.67'), 'external_system': 'CEI',
             'id': 'CEIEMBR315693696005018671', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1570665600'), 'operation': 'BUY', 'ticker': 'EMBR3', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('17.11'), 'external_system': 'CEI',
             'id': 'CEIEMBR315706656001017111', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1573084800'), 'operation': 'SELL', 'ticker': 'EMBR3', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('18.14'), 'external_system': 'CEI',
             'id': 'CEIEMBR3157308480010018141', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1573084800'), 'operation': 'SELL', 'ticker': 'EMBR3', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('18.14'), 'external_system': 'CEI',
             'id': 'CEIEMBR315730848001018141', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1573084800'), 'operation': 'SELL', 'ticker': 'EMBR3', 'costs': Decimal('0'),
             'amount': Decimal('2'), 'price': Decimal('18.2'), 'external_system': 'CEI',
             'id': 'CEIEMBR31573084800218201', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1573084800'), 'operation': 'SELL', 'ticker': 'EMBR3', 'costs': Decimal('0'),
             'amount': Decimal('31'), 'price': Decimal('18.14'), 'external_system': 'CEI',
             'id': 'CEIEMBR315730848003118141', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1573084800'), 'operation': 'SELL', 'ticker': 'EMBR3', 'costs': Decimal('0'),
             'amount': Decimal('34'), 'price': Decimal('18.14'), 'external_system': 'CEI',
             'id': 'CEIEMBR315730848003418141', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1573084800'), 'operation': 'SELL', 'ticker': 'EMBR3', 'costs': Decimal('0'),
             'amount': Decimal('4'), 'price': Decimal('18.14'), 'external_system': 'CEI',
             'id': 'CEIEMBR31573084800418141', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1573084800'), 'operation': 'SELL', 'ticker': 'FLRY3', 'costs': Decimal('0'),
             'amount': Decimal('1'), 'price': Decimal('26.2'), 'external_system': 'CEI',
             'id': 'CEIFLRY31573084800126201', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1573084800'), 'operation': 'SELL', 'ticker': 'FLRY3', 'costs': Decimal('0'),
             'amount': Decimal('1'), 'price': Decimal('26.21'), 'external_system': 'CEI',
             'id': 'CEIFLRY31573084800126211', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1573084800'), 'operation': 'SELL', 'ticker': 'FLRY3', 'costs': Decimal('0'),
             'amount': Decimal('20'), 'price': Decimal('26.2'), 'external_system': 'CEI',
             'id': 'CEIFLRY315730848002026201', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1573084800'), 'operation': 'SELL', 'ticker': 'FLRY3', 'costs': Decimal('0'),
             'amount': Decimal('33'), 'price': Decimal('26.2'), 'external_system': 'CEI',
             'id': 'CEIFLRY315730848003326201', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583884800'), 'operation': 'BUY', 'ticker': 'FLRY3', 'costs': Decimal('0'),
             'amount': Decimal('20'), 'price': Decimal('24.68'), 'external_system': 'CEI',
             'id': 'CEIFLRY315838848002024681', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1584489600'), 'operation': 'BUY', 'ticker': 'FLRY3', 'costs': Decimal('0'),
             'amount': Decimal('25'), 'price': Decimal('19.78'), 'external_system': 'CEI',
             'id': 'CEIFLRY315844896002519781', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1604880000'), 'operation': 'SELL', 'ticker': 'FLRY3', 'costs': Decimal('0'),
             'amount': Decimal('13'), 'price': Decimal('28.88'), 'external_system': 'CEI',
             'id': 'CEIFLRY316048800001328881', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1982 - MODAL DTVM LTDA',
             'date': Decimal('1569369600'), 'operation': 'BUY', 'ticker': 'HGBS11', 'costs': Decimal('0'),
             'amount': Decimal('1'), 'price': Decimal('251.94'), 'external_system': 'CEI',
             'id': 'CEIHGBS1115693696001251941', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1982 - MODAL DTVM LTDA',
             'date': Decimal('1569369600'), 'operation': 'BUY', 'ticker': 'HGBS11', 'costs': Decimal('0'),
             'amount': Decimal('3'), 'price': Decimal('251.9'), 'external_system': 'CEI',
             'id': 'CEIHGBS1115693696003251901', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1566518400'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('8'), 'price': Decimal('12.07'), 'external_system': 'CEI',
             'id': 'CEIITSA41566518400812071', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1567382400'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('4'), 'price': Decimal('12.26'), 'external_system': 'CEI',
             'id': 'CEIITSA41567382400412261', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1568764800'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('1'), 'price': Decimal('13.2'), 'external_system': 'CEI',
             'id': 'CEIITSA41568764800113201', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1568851200'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('2'), 'price': Decimal('13.27'), 'external_system': 'CEI',
             'id': 'CEIITSA41568851200213271', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1568851200'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('2'), 'price': Decimal('13.27'), 'external_system': 'CEI',
             'id': 'CEIITSA41568851200213272', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1568851200'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('7'), 'price': Decimal('13.27'), 'external_system': 'CEI',
             'id': 'CEIITSA41568851200713271', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1569369600'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('2'), 'price': Decimal('13.02'), 'external_system': 'CEI',
             'id': 'CEIITSA41569369600213021', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1569974400'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('12.63'), 'external_system': 'CEI',
             'id': 'CEIITSA4156997440010012631', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1570492800'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('14'), 'price': Decimal('12.26'), 'external_system': 'CEI',
             'id': 'CEIITSA415704928001412261', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1570492800'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('12.26'), 'external_system': 'CEI',
             'id': 'CEIITSA41570492800512261', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1580428800'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('39'), 'price': Decimal('12.78'), 'external_system': 'CEI',
             'id': 'CEIITSA415804288003912781', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1582675200'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('36'), 'price': Decimal('12.2'), 'external_system': 'CEI',
             'id': 'CEIITSA415826752003612201', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1582675200'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('12.2'), 'external_system': 'CEI',
             'id': 'CEIITSA41582675200512201', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583452800'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('8'), 'price': Decimal('11.45'), 'external_system': 'CEI',
             'id': 'CEIITSA41583452800811451', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583452800'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('9'), 'price': Decimal('11.45'), 'external_system': 'CEI',
             'id': 'CEIITSA41583452800911451', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583884800'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('9.97'), 'external_system': 'CEI',
             'id': 'CEIITSA41583884800109971', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583884800'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('30'), 'price': Decimal('10.27'), 'external_system': 'CEI',
             'id': 'CEIITSA415838848003010271', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583971200'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('30'), 'price': Decimal('9.11'), 'external_system': 'CEI',
             'id': 'CEIITSA41583971200309111', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1584489600'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('18'), 'price': Decimal('9.13'), 'external_system': 'CEI',
             'id': 'CEIITSA41584489600189131', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1584489600'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('37'), 'price': Decimal('9.13'), 'external_system': 'CEI',
             'id': 'CEIITSA41584489600379131', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1587686400'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('8.38'), 'external_system': 'CEI',
             'id': 'CEIITSA415876864001008381', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1600646400'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('8.97'), 'external_system': 'CEI',
             'id': 'CEIITSA416006464001008971', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1604880000'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('1'), 'price': Decimal('10.38'), 'external_system': 'CEI',
             'id': 'CEIITSA41604880000110381', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1604880000'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('21'), 'price': Decimal('10.38'), 'external_system': 'CEI',
             'id': 'CEIITSA416048800002110381', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1604880000'), 'operation': 'BUY', 'ticker': 'ITSA4', 'costs': Decimal('0'),
             'amount': Decimal('62'), 'price': Decimal('10.38'), 'external_system': 'CEI',
             'id': 'CEIITSA416048800006210381', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1589932800'), 'operation': 'BUY', 'ticker': 'IVVB11', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('181.92'), 'external_system': 'CEI',
             'id': 'CEIIVVB11158993280010181921', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1594252800'), 'operation': 'BUY', 'ticker': 'IVVB11', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('179.46'), 'external_system': 'CEI',
             'id': 'CEIIVVB11159425280010179461', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1565827200'), 'operation': 'BUY', 'ticker': 'MDIA3', 'costs': Decimal('0'),
             'amount': Decimal('16'), 'price': Decimal('36.7'), 'external_system': 'CEI',
             'id': 'CEIMDIA315658272001636701', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1567382400'), 'operation': 'BUY', 'ticker': 'MDIA3', 'costs': Decimal('0'),
             'amount': Decimal('27'), 'price': Decimal('36.11'), 'external_system': 'CEI',
             'id': 'CEIMDIA315673824002736111', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1567987200'), 'operation': 'BUY', 'ticker': 'MDIA3', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('36.39'), 'external_system': 'CEI',
             'id': 'CEIMDIA315679872001036391', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1567987200'), 'operation': 'BUY', 'ticker': 'MDIA3', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('36.39'), 'external_system': 'CEI',
             'id': 'CEIMDIA31567987200536391', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1568764800'), 'operation': 'BUY', 'ticker': 'MDIA3', 'costs': Decimal('0'),
             'amount': Decimal('15'), 'price': Decimal('35.1'), 'external_system': 'CEI',
             'id': 'CEIMDIA315687648001535101', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1568764800'), 'operation': 'BUY', 'ticker': 'MDIA3', 'costs': Decimal('0'),
             'amount': Decimal('15'), 'price': Decimal('35.18'), 'external_system': 'CEI',
             'id': 'CEIMDIA315687648001535181', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1569369600'), 'operation': 'BUY', 'ticker': 'MDIA3', 'costs': Decimal('0'),
             'amount': Decimal('11'), 'price': Decimal('35.44'), 'external_system': 'CEI',
             'id': 'CEIMDIA315693696001135441', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1604880000'), 'operation': 'SELL', 'ticker': 'MDIA3', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('35.14'), 'external_system': 'CEI',
             'id': 'CEIMDIA3160488000010035141', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1604880000'), 'operation': 'SELL', 'ticker': 'MDIA3', 'costs': Decimal('0'),
             'amount': Decimal('56'), 'price': Decimal('35.11'), 'external_system': 'CEI',
             'id': 'CEIMDIA316048800005635111', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1582761600'), 'operation': 'BUY', 'ticker': 'MGLU3', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('52.26'), 'external_system': 'CEI',
             'id': 'CEIMGLU315827616001052261', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583366400'), 'operation': 'BUY', 'ticker': 'MGLU3', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('49.05'), 'external_system': 'CEI',
             'id': 'CEIMGLU315833664001049051', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583452800'), 'operation': 'BUY', 'ticker': 'MGLU3', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('44.07'), 'external_system': 'CEI',
             'id': 'CEIMGLU31583452800544071', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583712000'), 'operation': 'BUY', 'ticker': 'MGLU3', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('39.68'), 'external_system': 'CEI',
             'id': 'CEIMGLU315837120001039681', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583971200'), 'operation': 'BUY', 'ticker': 'MGLU3', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('34.32'), 'external_system': 'CEI',
             'id': 'CEIMGLU315839712001034321', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583971200'), 'operation': 'BUY', 'ticker': 'MGLU3', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('31.54'), 'external_system': 'CEI',
             'id': 'CEIMGLU31583971200531541', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1584489600'), 'operation': 'BUY', 'ticker': 'MGLU3', 'costs': Decimal('0'),
             'amount': Decimal('15'), 'price': Decimal('33.13'), 'external_system': 'CEI',
             'id': 'CEIMGLU315844896001533131', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1602201600'), 'operation': 'BUY', 'ticker': 'MGLU3', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('95.7'), 'external_system': 'CEI',
             'id': 'CEIMGLU316022016001095701', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1602201600'), 'operation': 'BUY', 'ticker': 'MGLU3', 'costs': Decimal('0'),
             'amount': Decimal('32'), 'price': Decimal('95.7'), 'external_system': 'CEI',
             'id': 'CEIMGLU316022016003295701', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583971200'), 'operation': 'BUY', 'ticker': 'MYPK3', 'costs': Decimal('0'),
             'amount': Decimal('2'), 'price': Decimal('12.74'), 'external_system': 'CEI',
             'id': 'CEIMYPK31583971200212741', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583971200'), 'operation': 'BUY', 'ticker': 'MYPK3', 'costs': Decimal('0'),
             'amount': Decimal('48'), 'price': Decimal('12.74'), 'external_system': 'CEI',
             'id': 'CEIMYPK315839712004812741', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1587686400'), 'operation': 'BUY', 'ticker': 'MYPK3', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('12'), 'external_system': 'CEI',
             'id': 'CEIMYPK315876864001012001', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1587686400'), 'operation': 'BUY', 'ticker': 'MYPK3', 'costs': Decimal('0'),
             'amount': Decimal('40'), 'price': Decimal('12.19'), 'external_system': 'CEI',
             'id': 'CEIMYPK315876864004012191', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1594252800'), 'operation': 'BUY', 'ticker': 'RBRP11', 'costs': Decimal('0'),
             'amount': Decimal('23'), 'price': Decimal('90.2'), 'external_system': 'CEI',
             'id': 'CEIRBRP1115942528002390201', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1597104000'), 'operation': 'BUY', 'ticker': 'RBRP11', 'costs': Decimal('0'),
             'amount': Decimal('19'), 'price': Decimal('88.1'), 'external_system': 'CEI',
             'id': 'CEIRBRP1115971040001988101', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1597104000'), 'operation': 'BUY', 'ticker': 'RBRP11', 'costs': Decimal('0'),
             'amount': Decimal('22'), 'price': Decimal('88.1'), 'external_system': 'CEI',
             'id': 'CEIRBRP1115971040002288101', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1599696000'), 'operation': 'BUY', 'ticker': 'RBRP11', 'costs': Decimal('0'),
             'amount': Decimal('16'), 'price': Decimal('91.07'), 'external_system': 'CEI',
             'id': 'CEIRBRP1115996960001691071', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1605139200'), 'operation': 'BUY', 'ticker': 'RBRP11', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('92.2'), 'external_system': 'CEI',
             'id': 'CEIRBRP1116051392001092201', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1605139200'), 'operation': 'BUY', 'ticker': 'RBRP11', 'costs': Decimal('0'),
             'amount': Decimal('36'), 'price': Decimal('92.2'), 'external_system': 'CEI',
             'id': 'CEIRBRP1116051392003692201', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1566172800'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('54.1'), 'external_system': 'CEI',
             'id': 'CEISQIA315661728001054101', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1566172800'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('2'), 'price': Decimal('54.1'), 'external_system': 'CEI',
             'id': 'CEISQIA31566172800254101', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1566172800'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('2'), 'price': Decimal('54.1'), 'external_system': 'CEI',
             'id': 'CEISQIA31566172800254102', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1566172800'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('30'), 'price': Decimal('54.1'), 'external_system': 'CEI',
             'id': 'CEISQIA315661728003054101', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1566172800'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('3'), 'price': Decimal('54.1'), 'external_system': 'CEI',
             'id': 'CEISQIA31566172800354101', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1568764800'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('11'), 'price': Decimal('64.85'), 'external_system': 'CEI',
             'id': 'CEISQIA315687648001164851', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1568764800'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('2'), 'price': Decimal('64.85'), 'external_system': 'CEI',
             'id': 'CEISQIA31568764800264851', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1569369600'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('61.34'), 'external_system': 'CEI',
             'id': 'CEISQIA31569369600561341', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1569456000'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('47'), 'price': Decimal('61.5'), 'external_system': 'CEI',
             'id': 'CEISQIA315694560004761501', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1569456000'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('50'), 'price': Decimal('61.5'), 'external_system': 'CEI',
             'id': 'CEISQIA315694560005061501', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1569888000'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('15.59'), 'external_system': 'CEI',
             'id': 'CEISQIA3156988800010015591', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1569888000'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('15.59'), 'external_system': 'CEI',
             'id': 'CEISQIA3156988800010015592', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1569888000'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('15.59'), 'external_system': 'CEI',
             'id': 'CEISQIA3156988800010015593', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1569888000'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('20'), 'price': Decimal('15.57'), 'external_system': 'CEI',
             'id': 'CEISQIA315698880002015571', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1569888000'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('3'), 'price': Decimal('15.57'), 'external_system': 'CEI',
             'id': 'CEISQIA31569888000315571', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1569888000'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('50'), 'price': Decimal('15.57'), 'external_system': 'CEI',
             'id': 'CEISQIA315698880005015571', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1569888000'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('6'), 'price': Decimal('15.57'), 'external_system': 'CEI',
             'id': 'CEISQIA31569888000615571', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1569888000'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('9'), 'price': Decimal('15.57'), 'external_system': 'CEI',
             'id': 'CEISQIA31569888000915571', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1570665600'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('14.9'), 'external_system': 'CEI',
             'id': 'CEISQIA315706656001014901', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1571011200'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('15.07'), 'external_system': 'CEI',
             'id': 'CEISQIA31571011200515071', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1573084800'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('87'), 'price': Decimal('17.09'), 'external_system': 'CEI',
             'id': 'CEISQIA315730848008717091', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1580342400'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('15'), 'price': Decimal('25.11'), 'external_system': 'CEI',
             'id': 'CEISQIA315803424001525111', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1582675200'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('16'), 'price': Decimal('24.71'), 'external_system': 'CEI',
             'id': 'CEISQIA315826752001624711', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1582675200'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('9'), 'price': Decimal('24.71'), 'external_system': 'CEI',
             'id': 'CEISQIA31582675200924711', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1582848000'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('18'), 'price': Decimal('21.75'), 'external_system': 'CEI',
             'id': 'CEISQIA315828480001821751', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1582848000'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('3'), 'price': Decimal('21.69'), 'external_system': 'CEI',
             'id': 'CEISQIA31582848000321691', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1582848000'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('4'), 'price': Decimal('21.69'), 'external_system': 'CEI',
             'id': 'CEISQIA31582848000421691', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583366400'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('25'), 'price': Decimal('21.87'), 'external_system': 'CEI',
             'id': 'CEISQIA315833664002521871', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583452800'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('20'), 'price': Decimal('19.39'), 'external_system': 'CEI',
             'id': 'CEISQIA315834528002019391', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1583884800'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('17.04'), 'external_system': 'CEI',
             'id': 'CEISQIA315838848001017041', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1584489600'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('11.34'), 'external_system': 'CEI',
             'id': 'CEISQIA3158448960010011341', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1584489600'), 'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('35'), 'price': Decimal('13.6'), 'external_system': 'CEI',
             'id': 'CEISQIA315844896003513601', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1604880000'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('4'), 'price': Decimal('22.5'), 'external_system': 'CEI',
             'id': 'CEISQIA31604880000422501', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1604880000'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('22.5'), 'external_system': 'CEI',
             'id': 'CEISQIA31604880000522501', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1604880000'), 'operation': 'SELL', 'ticker': 'SQIA3', 'costs': Decimal('0'),
             'amount': Decimal('6'), 'price': Decimal('22.5'), 'external_system': 'CEI',
             'id': 'CEISQIA31604880000622501', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1569369600'), 'operation': 'BUY', 'ticker': 'TIET11', 'costs': Decimal('0'),
             'amount': Decimal('50'), 'price': Decimal('12.08'), 'external_system': 'CEI',
             'id': 'CEITIET1115693696005012081', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1570665600'), 'operation': 'BUY', 'ticker': 'TIET11', 'costs': Decimal('0'),
             'amount': Decimal('10'), 'price': Decimal('11.84'), 'external_system': 'CEI',
             'id': 'CEITIET1115706656001011841', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1570665600'), 'operation': 'BUY', 'ticker': 'TIET11', 'costs': Decimal('0'),
             'amount': Decimal('16'), 'price': Decimal('11.82'), 'external_system': 'CEI',
             'id': 'CEITIET1115706656001611821', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1565827200'), 'operation': 'BUY', 'ticker': 'USIM5', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('7.49'), 'external_system': 'CEI',
             'id': 'CEIUSIM515658272001007491', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1565827200'), 'operation': 'BUY', 'ticker': 'USIM5', 'costs': Decimal('0'),
             'amount': Decimal('1'), 'price': Decimal('7.49'), 'external_system': 'CEI',
             'id': 'CEIUSIM5156582720017491', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1566518400'), 'operation': 'BUY', 'ticker': 'USIM5', 'costs': Decimal('0'),
             'amount': Decimal('1'), 'price': Decimal('7.46'), 'external_system': 'CEI',
             'id': 'CEIUSIM5156651840017461', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1568764800'), 'operation': 'BUY', 'ticker': 'USIM5', 'costs': Decimal('0'),
             'amount': Decimal('1'), 'price': Decimal('8.38'), 'external_system': 'CEI',
             'id': 'CEIUSIM5156876480018381', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1569369600'), 'operation': 'BUY', 'ticker': 'USIM5', 'costs': Decimal('0'),
             'amount': Decimal('1'), 'price': Decimal('7.92'), 'external_system': 'CEI',
             'id': 'CEIUSIM5156936960017921', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1570665600'), 'operation': 'SELL', 'ticker': 'USIM5', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('7.58'), 'external_system': 'CEI',
             'id': 'CEIUSIM515706656001007581', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1570665600'), 'operation': 'SELL', 'ticker': 'USIM5', 'costs': Decimal('0'),
             'amount': Decimal('4'), 'price': Decimal('7.58'), 'external_system': 'CEI',
             'id': 'CEIUSIM5157066560047581', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1614297600'), 'operation': 'BUY', 'ticker': 'VALE3', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('96.55'), 'external_system': 'CEI',
             'id': 'CEIVALE3161429760010096551', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1614902400'), 'operation': 'SELL', 'ticker': 'VALE3', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('94.6'), 'external_system': 'CEI',
             'id': 'CEIVALE3161490240010094601', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1612828800'), 'operation': 'BUY', 'ticker': 'VGIP11', 'costs': Decimal('0'),
             'amount': Decimal('71'), 'price': Decimal('114.4'), 'external_system': 'CEI',
             'id': 'CEIVGIP11161282880071114401', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1570665600'), 'operation': 'SELL', 'ticker': 'VIVA3', 'costs': Decimal('0'),
             'amount': Decimal('8'), 'price': Decimal('24.71'), 'external_system': 'CEI',
             'id': 'CEIVIVA31570665600824711', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1584489600'), 'operation': 'BUY', 'ticker': 'VVAR3', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('4.89'), 'external_system': 'CEI',
             'id': 'CEIVVAR315844896001004891', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1584489600'), 'operation': 'BUY', 'ticker': 'VVAR3', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('5.97'), 'external_system': 'CEI',
             'id': 'CEIVVAR315844896001005971', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1585699200'), 'operation': 'BUY', 'ticker': 'VVAR3', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('4.67'), 'external_system': 'CEI',
             'id': 'CEIVVAR315856992001004671', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1595289600'), 'operation': 'SELL', 'ticker': 'VVAR3', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('20.76'), 'external_system': 'CEI',
             'id': 'CEIVVAR3159528960010020761', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1595289600'), 'operation': 'SELL', 'ticker': 'VVAR3', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('20.8'), 'external_system': 'CEI',
             'id': 'CEIVVAR3159528960010020801', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1565827200'), 'operation': 'BUY', 'ticker': 'WEGE3', 'costs': Decimal('0'),
             'amount': Decimal('72'), 'price': Decimal('22.74'), 'external_system': 'CEI',
             'id': 'CEIWEGE315658272007222741', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1566345600'), 'operation': 'BUY', 'ticker': 'WEGE3', 'costs': Decimal('0'),
             'amount': Decimal('51'), 'price': Decimal('22.8'), 'external_system': 'CEI',
             'id': 'CEIWEGE315663456005122801', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1567382400'), 'operation': 'BUY', 'ticker': 'WEGE3', 'costs': Decimal('0'),
             'amount': Decimal('1'), 'price': Decimal('22.62'), 'external_system': 'CEI',
             'id': 'CEIWEGE31567382400122621', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1567382400'), 'operation': 'BUY', 'ticker': 'WEGE3', 'costs': Decimal('0'),
             'amount': Decimal('75'), 'price': Decimal('22.62'), 'external_system': 'CEI',
             'id': 'CEIWEGE315673824007522621', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1569369600'), 'operation': 'BUY', 'ticker': 'WEGE3', 'costs': Decimal('0'),
             'amount': Decimal('15'), 'price': Decimal('24.1'), 'external_system': 'CEI',
             'id': 'CEIWEGE315693696001524101', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1570665600'), 'operation': 'BUY', 'ticker': 'WEGE3', 'costs': Decimal('0'),
             'amount': Decimal('5'), 'price': Decimal('23.08'), 'external_system': 'CEI',
             'id': 'CEIWEGE31570665600523081', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1584489600'), 'operation': 'BUY', 'ticker': 'WEGE3', 'costs': Decimal('0'),
             'amount': Decimal('20'), 'price': Decimal('26.28'), 'external_system': 'CEI',
             'id': 'CEIWEGE315844896002026281', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1585699200'), 'operation': 'BUY', 'ticker': 'WEGE3', 'costs': Decimal('0'),
             'amount': Decimal('15'), 'price': Decimal('32.2'), 'external_system': 'CEI',
             'id': 'CEIWEGE315856992001532201', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1587686400'), 'operation': 'BUY', 'ticker': 'WEGE3', 'costs': Decimal('0'),
             'amount': Decimal('15'), 'price': Decimal('37.08'), 'external_system': 'CEI',
             'id': 'CEIWEGE315876864001537081', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '308 - CLEAR CORRETORA - GRUPO XP',
             'date': Decimal('1604880000'), 'operation': 'SELL', 'ticker': 'WEGE3', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('83.71'), 'external_system': 'CEI',
             'id': 'CEIWEGE3160488000010083711', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': '1099 - INTER DTVM LTDA',
             'date': Decimal('1615248000'), 'operation': 'BUY', 'ticker': 'XINA11', 'costs': Decimal('0'),
             'amount': Decimal('100'), 'price': Decimal('11.93'), 'external_system': 'CEI',
             'id': 'CEIXINA11161524800010011931', 'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1553482800'),
             'operation': 'BUY', 'ticker': 'BRCR11', 'costs': Decimal('0'), 'amount': Decimal('8'),
             'price': Decimal('96.67'), 'external_system': '', 'id': 'a36e1b18-29b8-444a-bf5d-b14ddce47828',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'CLEAR', 'date': Decimal('1560481200'),
             'operation': 'BUY', 'ticker': 'FLRY3', 'costs': Decimal('0'), 'amount': Decimal('19'),
             'price': Decimal('21.05'), 'external_system': '', 'id': 'a5ef1879-2ec2-480d-80c8-c40b6d8e4ad2',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1556074800'),
             'operation': 'BUY', 'ticker': 'KNRI11', 'costs': Decimal('0'), 'amount': Decimal('3'),
             'price': Decimal('151.8'), 'external_system': '', 'id': 'ace58fe8-5a2c-4a8f-80da-5f421df46755',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'CLEAR', 'date': Decimal('1563937200'),
             'operation': 'BUY', 'ticker': 'TIET11', 'costs': Decimal('0'), 'amount': Decimal('10'),
             'price': Decimal('12.72'), 'external_system': '', 'id': 'b5f909cb-7c56-4079-b497-e51cb5cd6b71',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1554778800'),
             'operation': 'SELL', 'ticker': 'FLRY3', 'costs': Decimal('0'), 'amount': Decimal('100'),
             'price': Decimal('23.04'), 'external_system': '', 'id': 'c0dda9fb-ed22-4c65-80ff-368ff32eb545',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'Modal', 'date': Decimal('1553482800'),
             'operation': 'BUY', 'ticker': 'HGLG11', 'costs': Decimal('0'), 'amount': Decimal('12'),
             'price': Decimal('159.14'), 'external_system': '', 'id': 'cf667eb4-fd8d-4ff3-92ac-717977bcbf3d',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'CLEAR', 'date': Decimal('1564542000'),
             'operation': 'BUY', 'ticker': 'FLRY3', 'costs': Decimal('0'), 'amount': Decimal('18'),
             'price': Decimal('23.39'), 'external_system': '', 'id': 'dfb4de3a-281a-432d-a2cb-9b1ec3b0fa26',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'CLEAR', 'date': Decimal('1560481200'),
             'operation': 'BUY', 'ticker': 'SQIA3', 'costs': Decimal('0'), 'amount': Decimal('34'),
             'price': Decimal('37.75'), 'external_system': '', 'id': 'edaa99d1-2151-4307-bde3-f4a6ec415f98',
             'type': 'STOCK'},
            {'subject': '440b0d96-395d-48bd-aaf2-58dbf7e68274', 'broker': 'CLEAR', 'date': Decimal('1564542000'),
             'operation': 'BUY', 'ticker': 'TIET11', 'costs': Decimal('0'), 'amount': Decimal('30'),
             'price': Decimal('12.7'), 'external_system': '', 'id': 'fc12f7b3-a4bd-49b5-a73f-5bf26b224b83',
             'type': 'STOCK'}], 'Count': 207, 'ScannedCount': 207,
            'ResponseMetadata': {'RequestId': '0S7O066SM74N1HI7USGH1EBL3FVV4KQNSO5AEMVJF66Q9ASUAAJG',
                                 'HTTPStatusCode': 200,
                                 'HTTPHeaders': {'server': 'Server', 'date': 'Sat, 13 Mar 2021 22:36:43 GMT',
                                                 'content-type': 'application/x-amz-json-1.0',
                                                 'content-length': '66785', 'connection': 'keep-alive',
                                                 'x-amzn-requestid': '0S7O066SM74N1HI7USGH1EBL3FVV4KQNSO5AEMVJF66Q9ASUAAJG',
                                                 'x-amz-crc32': '2818540416'}, 'RetryAttempts': 0}}
        return list(map(lambda i: InvestmentUtils.load_model_by_type(i['type'], i), result['Items']))

    def batch_save(self, investments: [Investment]):
        with self.__investments_table.batch_writer() as batch:
            for investment in investments:
                batch.put_item(Item=investment.to_dict())


class PortfolioRepository:
    def __init__(self):
        self._portfolio_table = boto3.resource('dynamodb').Table('Portfolio')

    def find(self, subject) -> Portfolio:
        result = self._portfolio_table.query(KeyConditionExpression=Key('subject').eq(subject))
        if result['Items']:
            return Portfolio(**result['Items'][0])
        print(f"No Portfolio yet for subject: {subject}")

    def save(self, portfolio: Portfolio):
        print(f'Saving portfolio: {asdict(portfolio)}')
        self._portfolio_table.put_item(Item=portfolio.to_dict())
