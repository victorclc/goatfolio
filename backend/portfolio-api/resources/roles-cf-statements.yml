- Effect: Allow
  Action:
    - dynamodb:Query
    - dynamodb:GetItem
    - dynamodb:PutItem
    - dynamodb:BatchWriteItem
  Resource:
    - !GetAtt PortfolioTable.Arn
    - Fn::Join:
        - ''
        - - !GetAtt PortfolioTable.Arn
          - '/index/*'
- Effect: Allow
  Action:
    - sqs:SendMessage
    - sqs:GetQueueUrl
  Resource:
    'Fn::ImportValue': ${self:provider.stage}-EventsToNotifyQueueArn
- Effect: Allow
  Action:
    - dynamodb:Query
    - dynamodb:GetItem
    - dynamodb:BatchGetItem
  Resource:
    'Fn::ImportValue': ${self:provider.stage}-MarketDataTableArnOutput
- Effect: Allow
  Action:
    - ssm:GetParameter
    - ssm:GetParameters
    - ssm:DescribeParameters
  Resource: arn:aws:ssm:${self:provider.region}:*:parameter/corporate-events-api-key
- Effect: Allow
  Principal: sns.amazonaws.com
  Action:
    - sqs:SendMessage
  Resource: !GetAtt PortfolioAddOrUpdatedInvestmentSubscriber.Arn
  Condition:
    ArnEquals:
      'Fn::ImportValue': ${self:provider.stage}-AddedOrUpdatedInvestmentTopic
