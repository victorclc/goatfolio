from datetime import datetime
from decimal import Decimal
from typing import List

import boto3
import requests
from dateutil.relativedelta import relativedelta


class B3CotaHistData:
    def __init__(self):
        self.codigo_negociacao = None
        self.data_pregao = None
        self.nome_resumido_empresa_emissora = None
        self.preco_abertura = None
        self.preco_ultimo = None
        self.preco_medio = None
        self.preco_maximo = None
        self.preco_minimo = None
        self.preco_melhor_oferta_compra = None
        self.preco_melhor_oferta_venda = None
        self.numero_de_negocios = None
        self.codigo_do_papel_no_sistema_isin_ou_codigo_interno_papel = None

        self.tipo_registro = None
        self.codigo_bdi = None
        self.tipo_mercado = None
        self.especificacao_papel = None
        self.prazo_dias_mercado_a_termo = None
        self.moeda_referencia = None
        self.quantidade_total_titulos_negociados = None
        self.volume_total_titulos_negociados = None
        self.preco_exercicio_mercado_opcoes_ou_valor_contrato_mercado_termo_secundario = (
            None
        )
        self.indicador_correcao_precos_exercicios_ou_valores_contrato_mercado_termo_secundario = (
            None
        )
        self.data_vencimento_mercado_opcoes_ou_termo = None
        self.fator_de_cotacao = None
        self.preco_exercicio_para_opcoes_referenciadas_em_dolar = None
        self.numero_distribuicao_papel = None

    def load_essentials(
        self,
        codigo_negociacao,
        data_pregao,
        nome_resumido_empresa_emissora,
        preco_abertura,
        preco_ultimo,
        preco_medio,
        preco_maximo,
        preco_minimo,
        preco_melhor_oferta_compra,
        preco_melhor_oferta_venda,
        numero_de_negocios,
        codigo_do_papel_no_sistema_isin_ou_codigo_interno_papel,
    ):
        self.codigo_negociacao = codigo_negociacao
        self.data_pregao = data_pregao
        self.nome_resumido_empresa_emissora = nome_resumido_empresa_emissora
        self.preco_abertura = preco_abertura
        self.preco_ultimo = preco_ultimo
        self.preco_medio = preco_medio
        self.preco_maximo = preco_maximo
        self.preco_minimo = preco_minimo
        self.preco_melhor_oferta_compra = preco_melhor_oferta_compra
        self.preco_melhor_oferta_venda = preco_melhor_oferta_venda
        self.numero_de_negocios = numero_de_negocios
        self.codigo_do_papel_no_sistema_isin_ou_codigo_interno_papel = (
            codigo_do_papel_no_sistema_isin_ou_codigo_interno_papel
        )

    def load_line(self, line: str):
        self.tipo_registro = line[0:2]
        self.data_pregao = f"{line[2:6]}-{line[6:8]}-{line[8:10]}"
        self.codigo_bdi = line[10:12]
        self.codigo_negociacao = line[12:24].strip()
        self.tipo_mercado = line[24:27]
        self.nome_resumido_empresa_emissora = line[27:39].strip()
        self.especificacao_papel = line[39:49]
        self.prazo_dias_mercado_a_termo = line[49:52]
        self.moeda_referencia = line[52:56]
        self.preco_abertura = (Decimal(line[56:69]) / 100).quantize(Decimal("0.01"))
        self.preco_maximo = (Decimal(line[69:82]) / 100).quantize(Decimal("0.01"))
        self.preco_minimo = (Decimal(line[82:95]) / 100).quantize(Decimal("0.01"))

        self.preco_medio = (Decimal(line[95:108]) / 100).quantize(Decimal("0.01"))
        self.preco_ultimo = (Decimal(line[108:121]) / 100).quantize(Decimal("0.01"))
        self.preco_melhor_oferta_compra = (Decimal(line[121:134]) / 100).quantize(
            Decimal("0.01")
        )
        self.preco_melhor_oferta_venda = (Decimal(line[134:147]) / 100).quantize(
            Decimal("0.01")
        )
        self.numero_de_negocios = (Decimal(line[147:152]) / 100).quantize(
            Decimal("0.01")
        )
        self.quantidade_total_titulos_negociados = line[152:170]
        self.volume_total_titulos_negociados = line[170:188]
        self.preco_exercicio_mercado_opcoes_ou_valor_contrato_mercado_termo_secundario = line[
            188:201
        ]
        self.indicador_correcao_precos_exercicios_ou_valores_contrato_mercado_termo_secundario = line[
            201:202
        ]

        self.data_vencimento_mercado_opcoes_ou_termo = line[202:210]
        self.fator_de_cotacao = line[210:217]
        self.preco_exercicio_para_opcoes_referenciadas_em_dolar = line[217:230]
        self.codigo_do_papel_no_sistema_isin_ou_codigo_interno_papel = line[230:242]
        self.numero_distribuicao_papel = line[242:245]

    def to_dict(self):
        return {
            "ticker": self.codigo_negociacao,
            "candle_date": self.data_pregao,
            "company_name": self.nome_resumido_empresa_emissora,
            "open_price": self.preco_abertura,
            "close_price": self.preco_ultimo,
            "average_price": self.preco_medio,
            "max_price": self.preco_maximo,
            "min_price": self.preco_minimo,
            "volume": self.numero_de_negocios,
            "isin_code": self.codigo_do_papel_no_sistema_isin_ou_codigo_interno_papel,
        }


class CotaHistRepository:
    def __init__(self):
        self.__table = boto3.resource("dynamodb").Table("MarketData")

    def save(self, data: B3CotaHistData):
        self.__table.put_item(Item=data.to_dict())

    def batch_save(self, series: List[B3CotaHistData]):
        with self.__table.batch_writer() as batch:
            for data in series:
                batch.put_item(Item=data.to_dict())


if __name__ == "__main__":
    response = {
        "chart": {
            "result": [
                {
                    "meta": {
                        "currency": "BRL",
                        "symbol": "^BVSP",
                        "exchangeName": "SAO",
                        "instrumentType": "INDEX",
                        "firstTradeDate": 735915600,
                        "regularMarketTime": 1635970740,
                        "gmtoffset": -7200,
                        "timezone": "BRST",
                        "exchangeTimezoneName": "America/Sao_Paulo",
                        "regularMarketPrice": 105616.88,
                        "chartPreviousClose": 24.5,
                        "priceHint": 2,
                        "currentTradingPeriod": {
                            "pre": {
                                "timezone": "BRST",
                                "end": 1636027200,
                                "start": 1636026300,
                                "gmtoffset": -7200,
                            },
                            "regular": {
                                "timezone": "BRST",
                                "end": 1636052400,
                                "start": 1636027200,
                                "gmtoffset": -7200,
                            },
                            "post": {
                                "timezone": "BRST",
                                "end": 1636056000,
                                "start": 1636052400,
                                "gmtoffset": -7200,
                            },
                        },
                        "dataGranularity": "1mo",
                        "range": "max",
                        "validRanges": [
                            "1d",
                            "5d",
                            "1mo",
                            "3mo",
                            "6mo",
                            "1y",
                            "2y",
                            "5y",
                            "10y",
                            "ytd",
                            "max",
                        ],
                    },
                    "timestamp": [
                        736225200,
                        738903600,
                        741495600,
                        744174000,
                        746852400,
                        749444400,
                        752119200,
                        754711200,
                        757389600,
                        760068000,
                        762490800,
                        765169200,
                        767761200,
                        770439600,
                        773031600,
                        775710000,
                        778388400,
                        780980400,
                        783655200,
                        786247200,
                        788925600,
                        791604000,
                        794026800,
                        796705200,
                        799297200,
                        801975600,
                        804567600,
                        807246000,
                        809924400,
                        812516400,
                        815191200,
                        817783200,
                        820461600,
                        823140000,
                        825649200,
                        828327600,
                        830919600,
                        833598000,
                        836190000,
                        838868400,
                        841546800,
                        844138800,
                        846813600,
                        849405600,
                        852084000,
                        854762400,
                        857185200,
                        859863600,
                        862455600,
                        865134000,
                        867726000,
                        870404400,
                        873082800,
                        875674800,
                        878349600,
                        880941600,
                        883620000,
                        886298400,
                        888721200,
                        891399600,
                        893991600,
                        896670000,
                        899262000,
                        901940400,
                        904618800,
                        907210800,
                        909885600,
                        912477600,
                        915156000,
                        917834400,
                        920257200,
                        922935600,
                        925527600,
                        928206000,
                        930798000,
                        933476400,
                        936154800,
                        938746800,
                        941421600,
                        944013600,
                        946692000,
                        949370400,
                        951879600,
                        954558000,
                        957150000,
                        959828400,
                        962420400,
                        965098800,
                        967777200,
                        970369200,
                        973044000,
                        975636000,
                        978314400,
                        980992800,
                        983415600,
                        986094000,
                        988686000,
                        991364400,
                        993956400,
                        996634800,
                        999313200,
                        1001905200,
                        1004580000,
                        1007172000,
                        1009850400,
                        1012528800,
                        1014951600,
                        1017630000,
                        1020222000,
                        1022900400,
                        1025492400,
                        1028170800,
                        1030849200,
                        1033441200,
                        1036119600,
                        1038708000,
                        1041386400,
                        1044064800,
                        1046487600,
                        1049166000,
                        1051758000,
                        1054436400,
                        1057028400,
                        1059706800,
                        1062385200,
                        1064977200,
                        1067652000,
                        1070244000,
                        1072922400,
                        1075600800,
                        1078110000,
                        1080788400,
                        1083380400,
                        1086058800,
                        1088650800,
                        1091329200,
                        1094007600,
                        1096599600,
                        1099278000,
                        1101866400,
                        1104544800,
                        1107223200,
                        1109646000,
                        1112324400,
                        1114916400,
                        1117594800,
                        1120186800,
                        1122865200,
                        1125543600,
                        1128135600,
                        1130810400,
                        1133402400,
                        1136080800,
                        1138759200,
                        1141182000,
                        1143860400,
                        1146452400,
                        1149130800,
                        1151722800,
                        1154401200,
                        1157079600,
                        1159671600,
                        1162350000,
                        1164938400,
                        1167616800,
                        1170295200,
                        1172718000,
                        1175396400,
                        1177988400,
                        1180666800,
                        1183258800,
                        1185937200,
                        1188615600,
                        1191207600,
                        1193882400,
                        1196474400,
                        1199152800,
                        1201831200,
                        1204340400,
                        1207018800,
                        1209610800,
                        1212289200,
                        1214881200,
                        1217559600,
                        1220238000,
                        1222830000,
                        1225504800,
                        1228096800,
                        1230775200,
                        1233453600,
                        1235876400,
                        1238554800,
                        1241146800,
                        1243825200,
                        1246417200,
                        1249095600,
                        1251774000,
                        1254366000,
                        1257040800,
                        1259632800,
                        1262311200,
                        1264989600,
                        1267412400,
                        1270090800,
                        1272682800,
                        1275361200,
                        1277953200,
                        1280631600,
                        1283310000,
                        1285902000,
                        1288576800,
                        1291168800,
                        1293847200,
                        1296525600,
                        1298948400,
                        1301626800,
                        1304218800,
                        1306897200,
                        1309489200,
                        1312167600,
                        1314846000,
                        1317438000,
                        1320112800,
                        1322704800,
                        1325383200,
                        1328061600,
                        1330570800,
                        1333249200,
                        1335841200,
                        1338519600,
                        1341111600,
                        1343790000,
                        1346468400,
                        1349060400,
                        1351735200,
                        1354327200,
                        1357005600,
                        1359684000,
                        1362106800,
                        1364785200,
                        1367377200,
                        1370055600,
                        1372647600,
                        1375326000,
                        1378004400,
                        1380596400,
                        1383271200,
                        1385863200,
                        1388541600,
                        1391220000,
                        1393642800,
                        1396321200,
                        1398913200,
                        1401591600,
                        1404183600,
                        1406862000,
                        1409540400,
                        1412132400,
                        1414807200,
                        1417399200,
                        1420077600,
                        1422756000,
                        1425178800,
                        1427857200,
                        1430449200,
                        1433127600,
                        1435719600,
                        1438398000,
                        1441076400,
                        1443668400,
                        1446343200,
                        1448935200,
                        1451613600,
                        1454292000,
                        1456801200,
                        1459479600,
                        1462071600,
                        1464750000,
                        1467342000,
                        1470020400,
                        1472698800,
                        1475290800,
                        1477965600,
                        1480557600,
                        1483236000,
                        1485914400,
                        1488337200,
                        1491015600,
                        1493607600,
                        1496286000,
                        1498878000,
                        1501556400,
                        1504234800,
                        1506826800,
                        1509501600,
                        1512093600,
                        1514772000,
                        1517450400,
                        1519873200,
                        1522551600,
                        1525143600,
                        1527822000,
                        1530414000,
                        1533092400,
                        1535770800,
                        1538362800,
                        1541037600,
                        1543629600,
                        1546308000,
                        1548986400,
                        1551409200,
                        1554087600,
                        1556679600,
                        1559358000,
                        1561950000,
                        1564628400,
                        1567306800,
                        1569898800,
                        1572573600,
                        1575165600,
                        1577844000,
                        1580522400,
                        1583031600,
                        1585710000,
                        1588302000,
                        1590980400,
                        1593572400,
                        1596250800,
                        1598929200,
                        1601521200,
                        1604196000,
                        1606788000,
                        1609466400,
                        1612144800,
                        1614567600,
                        1617246000,
                        1619838000,
                        1622516400,
                        1625108400,
                        1627786800,
                        1630465200,
                        1633057200,
                        1635732000,
                        1635970740,
                    ],
                    "indicators": {
                        "quote": [
                            {
                                "low": [
                                    23.799999237060547,
                                    35.400001525878906,
                                    51.70000076293945,
                                    60.599998474121094,
                                    96.4000015258789,
                                    146.60000610351562,
                                    184.39999389648438,
                                    266.79998779296875,
                                    373.3999938964844,
                                    740.5999755859375,
                                    1013.7999877929688,
                                    1280.199951171875,
                                    1325.5,
                                    2437.10009765625,
                                    3486.0,
                                    4091.10009765625,
                                    4792.5,
                                    4283.7001953125,
                                    4219.2001953125,
                                    3990.800048828125,
                                    3108.60009765625,
                                    2762.0,
                                    2110.0,
                                    2867.10009765625,
                                    3688.89990234375,
                                    3516.0,
                                    3574.39990234375,
                                    3817.699951171875,
                                    4310.5,
                                    3922.699951171875,
                                    3713.699951171875,
                                    3957.60009765625,
                                    4299.0,
                                    4939.60009765625,
                                    4595.60009765625,
                                    4831.2001953125,
                                    5097.2998046875,
                                    5397.7998046875,
                                    5879.39990234375,
                                    6016.0,
                                    6132.2998046875,
                                    6316.89990234375,
                                    6478.89990234375,
                                    6445.10009765625,
                                    6952.5,
                                    7963.2998046875,
                                    8707.0,
                                    8982.0,
                                    9982.0,
                                    10988.0,
                                    10765.0,
                                    10518.0,
                                    9921.0,
                                    8456.0,
                                    7522.0,
                                    8853.0,
                                    8441.0,
                                    9716.0,
                                    10572.0,
                                    11051.0,
                                    8971.0,
                                    9062.0,
                                    9678.0,
                                    6454.0,
                                    4576.0,
                                    5878.0,
                                    7047.0,
                                    6378.0,
                                    4797.0,
                                    8160.0,
                                    8912.0,
                                    10676.0,
                                    10563.0,
                                    10666.0,
                                    10345.0,
                                    9579.0,
                                    10583.0,
                                    10796.0,
                                    11685.0,
                                    13556.0,
                                    15350.0,
                                    16389.0,
                                    16922.0,
                                    14029.0,
                                    13556.0,
                                    14967.0,
                                    16390.0,
                                    16073.0,
                                    15657.0,
                                    13571.0,
                                    12969.0,
                                    13242.0,
                                    15174.0,
                                    15558.0,
                                    13761.0,
                                    13325.0,
                                    14056.0,
                                    14164.0,
                                    13361.0,
                                    12681.0,
                                    9533.0,
                                    9985.0,
                                    11177.0,
                                    12809.0,
                                    12301.0,
                                    12415.0,
                                    13183.0,
                                    13032.0,
                                    11943.0,
                                    10247.0,
                                    9155.0,
                                    9017.0,
                                    8352.0,
                                    8225.0,
                                    9569.0,
                                    10307.0,
                                    10457.0,
                                    9968.0,
                                    10104.0,
                                    11283.0,
                                    12542.0,
                                    12895.0,
                                    12893.0,
                                    12757.0,
                                    15075.0,
                                    16010.0,
                                    17983.0,
                                    20184.0,
                                    21649.0,
                                    20092.0,
                                    20756.0,
                                    19508.0,
                                    17601.0,
                                    19177.0,
                                    20821.0,
                                    21178.0,
                                    21739.0,
                                    22390.0,
                                    22941.0,
                                    24452.0,
                                    23534.0,
                                    24073.0,
                                    25761.0,
                                    24154.0,
                                    23680.0,
                                    24224.0,
                                    24192.0,
                                    25734.0,
                                    27799.0,
                                    28161.0,
                                    29948.0,
                                    31921.0,
                                    32860.0,
                                    35891.0,
                                    36085.0,
                                    37816.0,
                                    34911.0,
                                    32057.0,
                                    34591.0,
                                    35123.0,
                                    34127.0,
                                    36438.0,
                                    39279.0,
                                    41192.0,
                                    41266.0,
                                    42571.0,
                                    41117.0,
                                    45225.0,
                                    48953.0,
                                    50885.0,
                                    52627.0,
                                    44938.0,
                                    52321.0,
                                    59473.0,
                                    58096.0,
                                    59414.0,
                                    53011.0,
                                    58030.0,
                                    57824.0,
                                    60965.0,
                                    67865.0,
                                    63689.0,
                                    56418.0,
                                    52345.0,
                                    43766.0,
                                    29435.0,
                                    31081.0,
                                    33798.0,
                                    36744.0,
                                    37324.0,
                                    35722.0,
                                    40256.0,
                                    47290.0,
                                    49130.0,
                                    48262.0,
                                    54766.0,
                                    55339.0,
                                    59678.0,
                                    60724.0,
                                    65925.0,
                                    64541.0,
                                    61341.0,
                                    66511.0,
                                    65914.0,
                                    57634.0,
                                    60936.0,
                                    60056.0,
                                    63804.0,
                                    65154.0,
                                    68847.0,
                                    67103.0,
                                    66948.0,
                                    65898.0,
                                    64016.0,
                                    65463.0,
                                    65105.0,
                                    61659.0,
                                    60489.0,
                                    58009.0,
                                    47793.0,
                                    51897.0,
                                    49433.0,
                                    54537.0,
                                    55298.0,
                                    57836.0,
                                    63085.0,
                                    64096.0,
                                    60897.0,
                                    53028.0,
                                    52271.0,
                                    52213.0,
                                    55239.0,
                                    56203.0,
                                    56581.0,
                                    55126.0,
                                    57129.0,
                                    59114.0,
                                    55430.0,
                                    54648.0,
                                    52392.0,
                                    52942.0,
                                    45406.0,
                                    44107.0,
                                    47164.0,
                                    50012.0,
                                    51870.0,
                                    51290.0,
                                    49842.0,
                                    46814.0,
                                    46109.0,
                                    44905.0,
                                    49774.0,
                                    51239.0,
                                    51239.0,
                                    52735.0,
                                    55239.0,
                                    53536.0,
                                    48722.0,
                                    50886.0,
                                    45853.0,
                                    46484.0,
                                    46760.0,
                                    47905.0,
                                    51186.0,
                                    52760.0,
                                    52548.0,
                                    48624.0,
                                    42749.0,
                                    43767.0,
                                    44789.0,
                                    45106.0,
                                    43137.0,
                                    37046.0,
                                    38596.0,
                                    42795.0,
                                    47874.0,
                                    48292.0,
                                    48067.0,
                                    50825.0,
                                    55696.0,
                                    56459.0,
                                    58367.0,
                                    58322.0,
                                    56829.0,
                                    59371.0,
                                    63740.0,
                                    62496.0,
                                    62826.0,
                                    60315.0,
                                    60544.0,
                                    62035.0,
                                    65925.0,
                                    70846.0,
                                    73845.0,
                                    70825.0,
                                    71356.0,
                                    76403.0,
                                    79690.0,
                                    82889.0,
                                    82762.0,
                                    75337.0,
                                    69069.0,
                                    71935.0,
                                    74876.0,
                                    74275.0,
                                    78091.0,
                                    84030.0,
                                    83892.0,
                                    87536.0,
                                    93424.0,
                                    91584.0,
                                    92338.0,
                                    89409.0,
                                    95686.0,
                                    100073.0,
                                    95855.0,
                                    99406.0,
                                    99826.0,
                                    105261.0,
                                    108190.0,
                                    112825.0,
                                    99951.0,
                                    61691.0,
                                    67802.0,
                                    75697.0,
                                    86837.0,
                                    95062.0,
                                    98513.0,
                                    93408.0,
                                    93387.0,
                                    93968.0,
                                    108897.0,
                                    114887.0,
                                    109827.0,
                                    107319.0,
                                    114991.0,
                                    117631.0,
                                    126184.0,
                                    121748.0,
                                    114801.0,
                                    107520.0,
                                    102854.0,
                                    103514.0,
                                    0.0,
                                ],
                                "high": [
                                    35.599998474121094,
                                    54.79999923706055,
                                    67.4000015258789,
                                    100.0999984741211,
                                    150.3000030517578,
                                    207.0,
                                    287.0,
                                    378.6000061035156,
                                    741.7000122070312,
                                    1116.0,
                                    1542.199951171875,
                                    1732.5999755859375,
                                    2516.89990234375,
                                    3885.699951171875,
                                    4272.7998046875,
                                    5443.2998046875,
                                    5637.7001953125,
                                    5528.2998046875,
                                    5086.2001953125,
                                    5023.39990234375,
                                    4397.60009765625,
                                    4067.199951171875,
                                    3494.89990234375,
                                    3923.60009765625,
                                    4185.10009765625,
                                    4067.300048828125,
                                    4079.5,
                                    4554.60009765625,
                                    4885.10009765625,
                                    4684.89990234375,
                                    4390.7001953125,
                                    4397.2998046875,
                                    5171.60009765625,
                                    5410.89990234375,
                                    5224.39990234375,
                                    5175.2001953125,
                                    5764.2001953125,
                                    6278.89990234375,
                                    6713.2001953125,
                                    6400.7998046875,
                                    6631.5,
                                    6851.5,
                                    6757.7998046875,
                                    7052.5,
                                    7991.7998046875,
                                    9181.099609375,
                                    9568.0,
                                    10000.0,
                                    11458.0,
                                    13223.0,
                                    14005.0,
                                    12846.0,
                                    12020.0,
                                    13037.0,
                                    10334.0,
                                    10212.0,
                                    10655.0,
                                    10626.0,
                                    12112.0,
                                    12339.0,
                                    11789.0,
                                    10563.0,
                                    11156.0,
                                    10705.0,
                                    7453.0,
                                    7630.0,
                                    9128.0,
                                    8738.0,
                                    8540.0,
                                    9267.0,
                                    11101.0,
                                    11827.0,
                                    12589.0,
                                    12118.0,
                                    11996.0,
                                    10726.0,
                                    11735.0,
                                    11826.0,
                                    14054.0,
                                    17105.0,
                                    18099.0,
                                    18886.0,
                                    19047.0,
                                    17826.0,
                                    15944.0,
                                    17396.0,
                                    17795.0,
                                    17926.0,
                                    17716.0,
                                    16404.0,
                                    15191.0,
                                    15415.0,
                                    18023.0,
                                    17673.0,
                                    16813.0,
                                    15267.0,
                                    15304.0,
                                    15644.0,
                                    14771.0,
                                    14143.0,
                                    12947.0,
                                    11924.0,
                                    13791.0,
                                    13969.0,
                                    14413.0,
                                    14251.0,
                                    14495.0,
                                    13872.0,
                                    13090.0,
                                    12919.0,
                                    11173.0,
                                    10763.0,
                                    10477.0,
                                    10598.0,
                                    10519.0,
                                    11648.0,
                                    12350.0,
                                    11067.0,
                                    11421.0,
                                    12820.0,
                                    13565.0,
                                    14072.0,
                                    13947.0,
                                    15252.0,
                                    17104.0,
                                    18660.0,
                                    20188.0,
                                    22310.0,
                                    24518.0,
                                    23374.0,
                                    23373.0,
                                    23260.0,
                                    20342.0,
                                    21183.0,
                                    22676.0,
                                    23381.0,
                                    23485.0,
                                    24362.0,
                                    25160.0,
                                    26270.0,
                                    26492.0,
                                    28778.0,
                                    29584.0,
                                    27178.0,
                                    25808.0,
                                    26755.0,
                                    26306.0,
                                    28072.0,
                                    31584.0,
                                    32052.0,
                                    32350.0,
                                    33837.0,
                                    38804.0,
                                    38978.0,
                                    39395.0,
                                    40425.0,
                                    42062.0,
                                    38437.0,
                                    37601.0,
                                    38172.0,
                                    37739.0,
                                    39843.0,
                                    42308.0,
                                    44675.0,
                                    45388.0,
                                    46752.0,
                                    45950.0,
                                    49856.0,
                                    52877.0,
                                    55003.0,
                                    58293.0,
                                    55616.0,
                                    61054.0,
                                    65949.0,
                                    65317.0,
                                    66529.0,
                                    63906.0,
                                    66005.0,
                                    65045.0,
                                    68038.0,
                                    73920.0,
                                    72593.0,
                                    65018.0,
                                    59505.0,
                                    55665.0,
                                    49834.0,
                                    41003.0,
                                    40498.0,
                                    42525.0,
                                    43441.0,
                                    42680.0,
                                    48126.0,
                                    53806.0,
                                    54955.0,
                                    55083.0,
                                    58634.0,
                                    62017.0,
                                    67530.0,
                                    68060.0,
                                    69785.0,
                                    71068.0,
                                    68120.0,
                                    70486.0,
                                    71989.0,
                                    67969.0,
                                    65831.0,
                                    67608.0,
                                    68754.0,
                                    69737.0,
                                    72140.0,
                                    73103.0,
                                    70589.0,
                                    71924.0,
                                    68226.0,
                                    68606.0,
                                    70108.0,
                                    66500.0,
                                    64979.0,
                                    63891.0,
                                    59542.0,
                                    58589.0,
                                    59901.0,
                                    59616.0,
                                    59576.0,
                                    63805.0,
                                    66662.0,
                                    68970.0,
                                    65593.0,
                                    62783.0,
                                    57611.0,
                                    57466.0,
                                    60209.0,
                                    63428.0,
                                    60412.0,
                                    59561.0,
                                    61322.0,
                                    63473.0,
                                    60496.0,
                                    59472.0,
                                    56976.0,
                                    57099.0,
                                    54289.0,
                                    49669.0,
                                    52398.0,
                                    55900.0,
                                    56747.0,
                                    54539.0,
                                    52479.0,
                                    51656.0,
                                    48669.0,
                                    50418.0,
                                    53394.0,
                                    54459.0,
                                    55284.0,
                                    58138.0,
                                    61442.0,
                                    62305.0,
                                    58897.0,
                                    57359.0,
                                    54719.0,
                                    50281.0,
                                    52457.0,
                                    52319.0,
                                    56965.0,
                                    58575.0,
                                    54361.0,
                                    53456.0,
                                    50867.0,
                                    49396.0,
                                    49752.0,
                                    49054.0,
                                    47142.0,
                                    43349.0,
                                    43601.0,
                                    52262.0,
                                    54978.0,
                                    54113.0,
                                    51812.0,
                                    57474.0,
                                    59418.0,
                                    60310.0,
                                    65054.0,
                                    65291.0,
                                    61936.0,
                                    66594.0,
                                    69488.0,
                                    67398.0,
                                    66211.0,
                                    68792.0,
                                    63637.0,
                                    66048.0,
                                    71506.0,
                                    76420.0,
                                    78024.0,
                                    75199.0,
                                    76437.0,
                                    86213.0,
                                    88318.0,
                                    87333.0,
                                    87179.0,
                                    86678.0,
                                    78892.0,
                                    80589.0,
                                    81792.0,
                                    80107.0,
                                    88377.0,
                                    90246.0,
                                    91242.0,
                                    98405.0,
                                    98589.0,
                                    100439.0,
                                    97610.0,
                                    97992.0,
                                    102617.0,
                                    106650.0,
                                    104848.0,
                                    106001.0,
                                    108408.0,
                                    109672.0,
                                    117803.0,
                                    119593.0,
                                    117701.0,
                                    108804.0,
                                    83598.0,
                                    88091.0,
                                    97693.0,
                                    105704.0,
                                    104523.0,
                                    103226.0,
                                    102218.0,
                                    111603.0,
                                    120150.0,
                                    125324.0,
                                    121117.0,
                                    117249.0,
                                    121974.0,
                                    126216.0,
                                    131190.0,
                                    129620.0,
                                    124536.0,
                                    119942.0,
                                    114927.0,
                                    106754.0,
                                    0.0,
                                ],
                                "close": [
                                    34.900001525878906,
                                    53.70000076293945,
                                    65.5999984741211,
                                    96.4000015258789,
                                    146.60000610351562,
                                    184.39999389648438,
                                    274.0,
                                    375.5,
                                    740.5999755859375,
                                    1053.9000244140625,
                                    1515.5999755859375,
                                    1708.4000244140625,
                                    2467.199951171875,
                                    3623.199951171875,
                                    4201.2998046875,
                                    5329.5,
                                    5484.0,
                                    4797.89990234375,
                                    4656.0,
                                    4353.89990234375,
                                    3885.0,
                                    3270.89990234375,
                                    2979.0,
                                    3813.699951171875,
                                    3720.60009765625,
                                    3603.39990234375,
                                    3877.5,
                                    4310.5,
                                    4670.10009765625,
                                    4128.39990234375,
                                    4378.60009765625,
                                    4299.0,
                                    5151.5,
                                    4957.7001953125,
                                    4954.89990234375,
                                    5164.10009765625,
                                    5728.0,
                                    6043.89990234375,
                                    6123.2998046875,
                                    6259.39990234375,
                                    6446.89990234375,
                                    6533.2001953125,
                                    6666.10009765625,
                                    7039.89990234375,
                                    7964.7001953125,
                                    8828.7001953125,
                                    9044.0,
                                    9982.0,
                                    11345.0,
                                    12568.0,
                                    12872.0,
                                    10609.0,
                                    11797.0,
                                    8986.0,
                                    9395.0,
                                    10197.0,
                                    9720.0,
                                    10571.0,
                                    11947.0,
                                    11677.0,
                                    9847.0,
                                    9678.0,
                                    10707.0,
                                    6472.0,
                                    6593.0,
                                    7047.0,
                                    8631.0,
                                    6784.0,
                                    8172.0,
                                    8911.0,
                                    10696.0,
                                    11351.0,
                                    11090.0,
                                    11627.0,
                                    10442.0,
                                    10565.0,
                                    11106.0,
                                    11700.0,
                                    13779.0,
                                    17092.0,
                                    16388.0,
                                    17660.0,
                                    17820.0,
                                    15538.0,
                                    14957.0,
                                    16728.0,
                                    16455.0,
                                    17347.0,
                                    15928.0,
                                    14867.0,
                                    13287.0,
                                    15259.0,
                                    17673.0,
                                    15891.0,
                                    14438.0,
                                    14918.0,
                                    14650.0,
                                    14560.0,
                                    13754.0,
                                    12841.0,
                                    10636.0,
                                    11365.0,
                                    12932.0,
                                    13578.0,
                                    12721.0,
                                    14033.0,
                                    13255.0,
                                    13085.0,
                                    12861.0,
                                    11139.0,
                                    9763.0,
                                    10382.0,
                                    8623.0,
                                    10168.0,
                                    10509.0,
                                    11268.0,
                                    10941.0,
                                    10281.0,
                                    11274.0,
                                    12557.0,
                                    13422.0,
                                    12973.0,
                                    13572.0,
                                    15174.0,
                                    16011.0,
                                    17982.0,
                                    20184.0,
                                    22236.0,
                                    21851.0,
                                    21755.0,
                                    22142.0,
                                    19607.0,
                                    19545.0,
                                    21149.0,
                                    22337.0,
                                    22803.0,
                                    23245.0,
                                    23052.0,
                                    25128.0,
                                    26196.0,
                                    24351.0,
                                    28139.0,
                                    26611.0,
                                    24844.0,
                                    25207.0,
                                    25051.0,
                                    26042.0,
                                    28045.0,
                                    31584.0,
                                    30194.0,
                                    31917.0,
                                    33456.0,
                                    38383.0,
                                    38610.0,
                                    37952.0,
                                    40363.0,
                                    36530.0,
                                    36631.0,
                                    37077.0,
                                    36232.0,
                                    36449.0,
                                    39263.0,
                                    41932.0,
                                    44474.0,
                                    44642.0,
                                    43892.0,
                                    45805.0,
                                    48956.0,
                                    52268.0,
                                    54392.0,
                                    54183.0,
                                    54637.0,
                                    60465.0,
                                    65318.0,
                                    63006.0,
                                    63886.0,
                                    59490.0,
                                    63489.0,
                                    60968.0,
                                    67868.0,
                                    72593.0,
                                    65018.0,
                                    59505.0,
                                    55680.0,
                                    49541.0,
                                    37257.0,
                                    36596.0,
                                    37550.0,
                                    39301.0,
                                    38183.0,
                                    40926.0,
                                    47290.0,
                                    53198.0,
                                    51465.0,
                                    54766.0,
                                    56489.0,
                                    61518.0,
                                    61546.0,
                                    67044.0,
                                    68588.0,
                                    65402.0,
                                    66503.0,
                                    70372.0,
                                    67530.0,
                                    63047.0,
                                    60936.0,
                                    67515.0,
                                    65145.0,
                                    69430.0,
                                    70673.0,
                                    67705.0,
                                    69305.0,
                                    66575.0,
                                    67383.0,
                                    68587.0,
                                    66133.0,
                                    64620.0,
                                    62404.0,
                                    58823.0,
                                    56495.0,
                                    52324.0,
                                    58338.0,
                                    56875.0,
                                    56754.0,
                                    63072.0,
                                    65812.0,
                                    64511.0,
                                    61820.0,
                                    54490.0,
                                    54355.0,
                                    56097.0,
                                    57061.0,
                                    59176.0,
                                    57068.0,
                                    57475.0,
                                    60952.0,
                                    59761.0,
                                    57424.0,
                                    56352.0,
                                    55910.0,
                                    53506.0,
                                    47457.0,
                                    48234.0,
                                    50008.0,
                                    52338.0,
                                    54256.0,
                                    52482.0,
                                    51507.0,
                                    47639.0,
                                    47094.0,
                                    50415.0,
                                    51626.0,
                                    51239.0,
                                    53168.0,
                                    55829.0,
                                    61288.0,
                                    54116.0,
                                    54629.0,
                                    54664.0,
                                    50007.0,
                                    46908.0,
                                    51583.0,
                                    51150.0,
                                    56229.0,
                                    52760.0,
                                    53081.0,
                                    50865.0,
                                    46626.0,
                                    45059.0,
                                    45869.0,
                                    45120.0,
                                    43350.0,
                                    40406.0,
                                    42794.0,
                                    50055.0,
                                    53911.0,
                                    48472.0,
                                    51527.0,
                                    57308.0,
                                    57901.0,
                                    58367.0,
                                    64925.0,
                                    61906.0,
                                    60227.0,
                                    64671.0,
                                    66662.0,
                                    64984.0,
                                    65403.0,
                                    62711.0,
                                    62900.0,
                                    65920.0,
                                    70835.0,
                                    74294.0,
                                    74308.0,
                                    71971.0,
                                    76402.0,
                                    84913.0,
                                    85481.0,
                                    85366.0,
                                    86115.0,
                                    76754.0,
                                    72763.0,
                                    79220.0,
                                    76678.0,
                                    79342.0,
                                    87424.0,
                                    89504.0,
                                    87887.0,
                                    97394.0,
                                    95584.0,
                                    95415.0,
                                    96353.0,
                                    97030.0,
                                    100967.0,
                                    101812.0,
                                    101135.0,
                                    104745.0,
                                    107220.0,
                                    108233.0,
                                    115645.0,
                                    113761.0,
                                    104172.0,
                                    73020.0,
                                    80506.0,
                                    87403.0,
                                    95056.0,
                                    102912.0,
                                    99369.0,
                                    94603.0,
                                    93952.0,
                                    108888.0,
                                    119306.0,
                                    116007.0,
                                    110035.0,
                                    116634.0,
                                    118894.0,
                                    126216.0,
                                    126802.0,
                                    121801.0,
                                    118781.0,
                                    110979.0,
                                    103501.0,
                                    105617.0,
                                    105616.8828125,
                                ],
                                "open": [
                                    24.100000381469727,
                                    35.400001525878906,
                                    53.70000076293945,
                                    65.5999984741211,
                                    96.4000015258789,
                                    146.60000610351562,
                                    184.39999389648438,
                                    274.0,
                                    375.5,
                                    740.5999755859375,
                                    1053.9000244140625,
                                    1515.5999755859375,
                                    1708.4000244140625,
                                    2467.199951171875,
                                    3623.199951171875,
                                    4201.2998046875,
                                    5329.5,
                                    5484.0,
                                    4744.89990234375,
                                    4656.0,
                                    4353.89990234375,
                                    3885.0,
                                    3270.89990234375,
                                    2979.0,
                                    3813.699951171875,
                                    3720.60009765625,
                                    3603.39990234375,
                                    3877.5,
                                    4310.5,
                                    4670.10009765625,
                                    4128.39990234375,
                                    4378.60009765625,
                                    4299.0,
                                    5151.5,
                                    5120.7998046875,
                                    5022.39990234375,
                                    5191.5,
                                    5725.7998046875,
                                    6043.89990234375,
                                    6308.2998046875,
                                    6269.10009765625,
                                    6446.89990234375,
                                    6533.2001953125,
                                    6739.2998046875,
                                    7040.0,
                                    8104.10009765625,
                                    8982.0,
                                    9140.0,
                                    10116.0,
                                    11398.0,
                                    13013.0,
                                    12846.0,
                                    10643.0,
                                    11799.0,
                                    8986.0,
                                    9396.0,
                                    10197.0,
                                    9716.0,
                                    10572.0,
                                    11950.0,
                                    11719.0,
                                    9750.0,
                                    9678.0,
                                    10705.0,
                                    6472.0,
                                    6593.0,
                                    7047.0,
                                    8631.0,
                                    6787.0,
                                    8187.0,
                                    8912.0,
                                    10697.0,
                                    11351.0,
                                    11090.0,
                                    11634.0,
                                    10441.0,
                                    10583.0,
                                    11105.0,
                                    11701.0,
                                    13784.0,
                                    17098.0,
                                    16389.0,
                                    17668.0,
                                    17826.0,
                                    15596.0,
                                    14967.0,
                                    16747.0,
                                    16475.0,
                                    17360.0,
                                    15950.0,
                                    14858.0,
                                    13303.0,
                                    15242.0,
                                    17670.0,
                                    15891.0,
                                    14441.0,
                                    14877.0,
                                    14654.0,
                                    14579.0,
                                    13757.0,
                                    12849.0,
                                    10633.0,
                                    11362.0,
                                    12914.0,
                                    13586.0,
                                    12723.0,
                                    14047.0,
                                    13256.0,
                                    13088.0,
                                    12859.0,
                                    11138.0,
                                    9782.0,
                                    10383.0,
                                    8642.0,
                                    10172.0,
                                    10517.0,
                                    11291.0,
                                    10943.0,
                                    10263.0,
                                    11283.0,
                                    12565.0,
                                    13441.0,
                                    12967.0,
                                    13579.0,
                                    15174.0,
                                    16010.0,
                                    17983.0,
                                    20184.0,
                                    22233.0,
                                    21842.0,
                                    21761.0,
                                    22142.0,
                                    19622.0,
                                    19545.0,
                                    21152.0,
                                    22342.0,
                                    22803.0,
                                    23246.0,
                                    23050.0,
                                    25129.0,
                                    26193.0,
                                    24392.0,
                                    28135.0,
                                    26612.0,
                                    24847.0,
                                    25209.0,
                                    25051.0,
                                    26042.0,
                                    28044.0,
                                    31582.0,
                                    30194.0,
                                    31921.0,
                                    33462.0,
                                    38382.0,
                                    38610.0,
                                    37952.0,
                                    40365.0,
                                    36531.0,
                                    36629.0,
                                    37077.0,
                                    36232.0,
                                    36450.0,
                                    39279.0,
                                    41930.0,
                                    44476.0,
                                    44642.0,
                                    43886.0,
                                    45805.0,
                                    48955.0,
                                    52271.0,
                                    54396.0,
                                    54170.0,
                                    54641.0,
                                    60465.0,
                                    65317.0,
                                    63018.0,
                                    63885.0,
                                    59491.0,
                                    63496.0,
                                    60965.0,
                                    67869.0,
                                    72593.0,
                                    65018.0,
                                    59505.0,
                                    55665.0,
                                    49538.0,
                                    37261.0,
                                    36596.0,
                                    37550.0,
                                    39296.0,
                                    38180.0,
                                    40918.0,
                                    47290.0,
                                    53202.0,
                                    51464.0,
                                    54766.0,
                                    56489.0,
                                    61519.0,
                                    61539.0,
                                    67051.0,
                                    68587.0,
                                    65402.0,
                                    66511.0,
                                    70375.0,
                                    67534.0,
                                    63033.0,
                                    60935.0,
                                    67524.0,
                                    65154.0,
                                    69438.0,
                                    70686.0,
                                    67731.0,
                                    69310.0,
                                    66575.0,
                                    67381.0,
                                    68588.0,
                                    66119.0,
                                    64616.0,
                                    62404.0,
                                    58823.0,
                                    56498.0,
                                    52319.0,
                                    58300.0,
                                    56876.0,
                                    57836.0,
                                    63085.0,
                                    65812.0,
                                    64515.0,
                                    61820.0,
                                    54488.0,
                                    54355.0,
                                    56091.0,
                                    57065.0,
                                    59171.0,
                                    57065.0,
                                    57479.0,
                                    60990.0,
                                    59764.0,
                                    57422.0,
                                    56348.0,
                                    55919.0,
                                    53512.0,
                                    47458.0,
                                    48235.0,
                                    50012.0,
                                    52337.0,
                                    54255.0,
                                    52479.0,
                                    51522.0,
                                    47623.0,
                                    47092.0,
                                    50412.0,
                                    51630.0,
                                    51239.0,
                                    53170.0,
                                    55827.0,
                                    61294.0,
                                    54115.0,
                                    54629.0,
                                    54719.0,
                                    50005.0,
                                    46933.0,
                                    51580.0,
                                    51186.0,
                                    56230.0,
                                    52753.0,
                                    53081.0,
                                    50867.0,
                                    46625.0,
                                    45064.0,
                                    45869.0,
                                    45121.0,
                                    43349.0,
                                    40397.0,
                                    42795.0,
                                    50054.0,
                                    53910.0,
                                    48468.0,
                                    51540.0,
                                    57309.0,
                                    57901.0,
                                    58370.0,
                                    64922.0,
                                    61906.0,
                                    60227.0,
                                    64687.0,
                                    66661.0,
                                    64989.0,
                                    65404.0,
                                    62711.0,
                                    62901.0,
                                    65925.0,
                                    70848.0,
                                    74295.0,
                                    74310.0,
                                    71955.0,
                                    76403.0,
                                    84913.0,
                                    85337.0,
                                    85365.0,
                                    86111.0,
                                    76779.0,
                                    72763.0,
                                    79213.0,
                                    76675.0,
                                    79350.0,
                                    87428.0,
                                    89511.0,
                                    87887.0,
                                    97395.0,
                                    95584.0,
                                    95423.0,
                                    96339.0,
                                    97036.0,
                                    100973.0,
                                    101819.0,
                                    101133.0,
                                    104745.0,
                                    107221.0,
                                    108246.0,
                                    115652.0,
                                    113761.0,
                                    104260.0,
                                    73011.0,
                                    80501.0,
                                    87395.0,
                                    95062.0,
                                    102913.0,
                                    99382.0,
                                    94604.0,
                                    93968.0,
                                    108897.0,
                                    119024.0,
                                    115093.0,
                                    110036.0,
                                    116644.0,
                                    118951.0,
                                    126218.0,
                                    126802.0,
                                    121803.0,
                                    118793.0,
                                    110980.0,
                                    103514.0,
                                    0.0,
                                ],
                                "volume": [
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    294019200,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    0,
                                    144235600,
                                    2391376300,
                                    2392852500,
                                    2175094500,
                                    1845604000,
                                    2010837900,
                                    2210915100,
                                    2898315900,
                                    2788661600,
                                    2311245000,
                                    2008111300,
                                    926311000,
                                    1151761800,
                                    106332200,
                                    146974800,
                                    111714400,
                                    39270200,
                                    75006400,
                                    62925000,
                                    48383600,
                                    21483400,
                                    25864000,
                                    24527600,
                                    28042800,
                                    22831800,
                                    35435000,
                                    46438000,
                                    33453000,
                                    32444400,
                                    33499800,
                                    30069600,
                                    35335800,
                                    34551000,
                                    35239600,
                                    30445600,
                                    29458000,
                                    27932200,
                                    28071600,
                                    33944200,
                                    30950400,
                                    25856400,
                                    32866000,
                                    27096400,
                                    37817200,
                                    34294000,
                                    52407200,
                                    36575200,
                                    34777400,
                                    38356200,
                                    43837400,
                                    48426200,
                                    30655600,
                                    27004200,
                                    41876200,
                                    48663800,
                                    45965400,
                                    34800400,
                                    48359800,
                                    39742200,
                                    41716000,
                                    72287600,
                                    54664800,
                                    53851800,
                                    48805400,
                                    50819200,
                                    52505600,
                                    52916000,
                                    55588800,
                                    54261600,
                                    77092600,
                                    62934200,
                                    59275600,
                                    75582200,
                                    70744000,
                                    62249200,
                                    62039600,
                                    62250400,
                                    77083400,
                                    71082200,
                                    86585200,
                                    106426600,
                                    108599200,
                                    114211000,
                                    113296800,
                                    145179900,
                                    125978800,
                                    129969800,
                                    65607500,
                                    54588400,
                                    73708400,
                                    64038100,
                                    67633000,
                                    72968400,
                                    73703300,
                                    53445000,
                                    68057900,
                                    72747400,
                                    83748800,
                                    115826000,
                                    67382100,
                                    69815600,
                                    77719800,
                                    65310100,
                                    79890000,
                                    81114600,
                                    67845700,
                                    61236200,
                                    65571800,
                                    71135200,
                                    79146200,
                                    78617500,
                                    66640000,
                                    64358600,
                                    70039500,
                                    73592000,
                                    121365300,
                                    88910200,
                                    79045000,
                                    79032100,
                                    75165800,
                                    80937900,
                                    68141200,
                                    74450900,
                                    83065700,
                                    64108500,
                                    60057300,
                                    56775200,
                                    73694400,
                                    51935600,
                                    86770000,
                                    65351300,
                                    53755900,
                                    68162600,
                                    68909400,
                                    65846200,
                                    65167600,
                                    54645300,
                                    71837300,
                                    71597200,
                                    70136200,
                                    61917800,
                                    96407700,
                                    93312000,
                                    63627800,
                                    77877000,
                                    59194500,
                                    110546700,
                                    83697300,
                                    79750200,
                                    101237300,
                                    95001600,
                                    86699500,
                                    90379400,
                                    98077700,
                                    88248100,
                                    94472500,
                                    118683900,
                                    93206100,
                                    103190700,
                                    95992100,
                                    99879900,
                                    122061200,
                                    122284500,
                                    270525000,
                                    209517900,
                                    220355900,
                                    232321100,
                                    212054200,
                                    202682200,
                                    182459100,
                                    198128300,
                                    217759400,
                                    177044900,
                                    186733700,
                                    190633700,
                                    215718800,
                                    158707300,
                                    171080700,
                                    197840500,
                                    152098400,
                                    201788600,
                                    231540400,
                                    243860400,
                                    25431700,
                                    0,
                                ],
                            }
                        ],
                        "adjclose": [
                            {
                                "adjclose": [
                                    34.900001525878906,
                                    53.70000076293945,
                                    65.5999984741211,
                                    96.4000015258789,
                                    146.60000610351562,
                                    184.39999389648438,
                                    274.0,
                                    375.5,
                                    740.5999755859375,
                                    1053.9000244140625,
                                    1515.5999755859375,
                                    1708.4000244140625,
                                    2467.199951171875,
                                    3623.199951171875,
                                    4201.2998046875,
                                    5329.5,
                                    5484.0,
                                    4797.89990234375,
                                    4656.0,
                                    4353.89990234375,
                                    3885.0,
                                    3270.89990234375,
                                    2979.0,
                                    3813.699951171875,
                                    3720.60009765625,
                                    3603.39990234375,
                                    3877.5,
                                    4310.5,
                                    4670.10009765625,
                                    4128.39990234375,
                                    4378.60009765625,
                                    4299.0,
                                    5151.5,
                                    4957.7001953125,
                                    4954.89990234375,
                                    5164.10009765625,
                                    5728.0,
                                    6043.89990234375,
                                    6123.2998046875,
                                    6259.39990234375,
                                    6446.89990234375,
                                    6533.2001953125,
                                    6666.10009765625,
                                    7039.89990234375,
                                    7964.7001953125,
                                    8828.7001953125,
                                    9044.0,
                                    9982.0,
                                    11345.0,
                                    12568.0,
                                    12872.0,
                                    10609.0,
                                    11797.0,
                                    8986.0,
                                    9395.0,
                                    10197.0,
                                    9720.0,
                                    10571.0,
                                    11947.0,
                                    11677.0,
                                    9847.0,
                                    9678.0,
                                    10707.0,
                                    6472.0,
                                    6593.0,
                                    7047.0,
                                    8631.0,
                                    6784.0,
                                    8172.0,
                                    8911.0,
                                    10696.0,
                                    11351.0,
                                    11090.0,
                                    11627.0,
                                    10442.0,
                                    10565.0,
                                    11106.0,
                                    11700.0,
                                    13779.0,
                                    17092.0,
                                    16388.0,
                                    17660.0,
                                    17820.0,
                                    15538.0,
                                    14957.0,
                                    16728.0,
                                    16455.0,
                                    17347.0,
                                    15928.0,
                                    14867.0,
                                    13287.0,
                                    15259.0,
                                    17673.0,
                                    15891.0,
                                    14438.0,
                                    14918.0,
                                    14650.0,
                                    14560.0,
                                    13754.0,
                                    12841.0,
                                    10636.0,
                                    11365.0,
                                    12932.0,
                                    13578.0,
                                    12721.0,
                                    14033.0,
                                    13255.0,
                                    13085.0,
                                    12861.0,
                                    11139.0,
                                    9763.0,
                                    10382.0,
                                    8623.0,
                                    10168.0,
                                    10509.0,
                                    11268.0,
                                    10941.0,
                                    10281.0,
                                    11274.0,
                                    12557.0,
                                    13422.0,
                                    12973.0,
                                    13572.0,
                                    15174.0,
                                    16011.0,
                                    17982.0,
                                    20184.0,
                                    22236.0,
                                    21851.0,
                                    21755.0,
                                    22142.0,
                                    19607.0,
                                    19545.0,
                                    21149.0,
                                    22337.0,
                                    22803.0,
                                    23245.0,
                                    23052.0,
                                    25128.0,
                                    26196.0,
                                    24351.0,
                                    28139.0,
                                    26611.0,
                                    24844.0,
                                    25207.0,
                                    25051.0,
                                    26042.0,
                                    28045.0,
                                    31584.0,
                                    30194.0,
                                    31917.0,
                                    33456.0,
                                    38383.0,
                                    38610.0,
                                    37952.0,
                                    40363.0,
                                    36530.0,
                                    36631.0,
                                    37077.0,
                                    36232.0,
                                    36449.0,
                                    39263.0,
                                    41932.0,
                                    44474.0,
                                    44642.0,
                                    43892.0,
                                    45805.0,
                                    48956.0,
                                    52268.0,
                                    54392.0,
                                    54183.0,
                                    54637.0,
                                    60465.0,
                                    65318.0,
                                    63006.0,
                                    63886.0,
                                    59490.0,
                                    63489.0,
                                    60968.0,
                                    67868.0,
                                    72593.0,
                                    65018.0,
                                    59505.0,
                                    55680.0,
                                    49541.0,
                                    37257.0,
                                    36596.0,
                                    37550.0,
                                    39301.0,
                                    38183.0,
                                    40926.0,
                                    47290.0,
                                    53198.0,
                                    51465.0,
                                    54766.0,
                                    56489.0,
                                    61518.0,
                                    61546.0,
                                    67044.0,
                                    68588.0,
                                    65402.0,
                                    66503.0,
                                    70372.0,
                                    67530.0,
                                    63047.0,
                                    60936.0,
                                    67515.0,
                                    65145.0,
                                    69430.0,
                                    70673.0,
                                    67705.0,
                                    69305.0,
                                    66575.0,
                                    67383.0,
                                    68587.0,
                                    66133.0,
                                    64620.0,
                                    62404.0,
                                    58823.0,
                                    56495.0,
                                    52324.0,
                                    58338.0,
                                    56875.0,
                                    56754.0,
                                    63072.0,
                                    65812.0,
                                    64511.0,
                                    61820.0,
                                    54490.0,
                                    54355.0,
                                    56097.0,
                                    57061.0,
                                    59176.0,
                                    57068.0,
                                    57475.0,
                                    60952.0,
                                    59761.0,
                                    57424.0,
                                    56352.0,
                                    55910.0,
                                    53506.0,
                                    47457.0,
                                    48234.0,
                                    50008.0,
                                    52338.0,
                                    54256.0,
                                    52482.0,
                                    51507.0,
                                    47639.0,
                                    47094.0,
                                    50415.0,
                                    51626.0,
                                    51239.0,
                                    53168.0,
                                    55829.0,
                                    61288.0,
                                    54116.0,
                                    54629.0,
                                    54664.0,
                                    50007.0,
                                    46908.0,
                                    51583.0,
                                    51150.0,
                                    56229.0,
                                    52760.0,
                                    53081.0,
                                    50865.0,
                                    46626.0,
                                    45059.0,
                                    45869.0,
                                    45120.0,
                                    43350.0,
                                    40406.0,
                                    42794.0,
                                    50055.0,
                                    53911.0,
                                    48472.0,
                                    51527.0,
                                    57308.0,
                                    57901.0,
                                    58367.0,
                                    64925.0,
                                    61906.0,
                                    60227.0,
                                    64671.0,
                                    66662.0,
                                    64984.0,
                                    65403.0,
                                    62711.0,
                                    62900.0,
                                    65920.0,
                                    70835.0,
                                    74294.0,
                                    74308.0,
                                    71971.0,
                                    76402.0,
                                    84913.0,
                                    85481.0,
                                    85366.0,
                                    86115.0,
                                    76754.0,
                                    72763.0,
                                    79220.0,
                                    76678.0,
                                    79342.0,
                                    87424.0,
                                    89504.0,
                                    87887.0,
                                    97394.0,
                                    95584.0,
                                    95415.0,
                                    96353.0,
                                    97030.0,
                                    100967.0,
                                    101812.0,
                                    101135.0,
                                    104745.0,
                                    107220.0,
                                    108233.0,
                                    115645.0,
                                    113761.0,
                                    104172.0,
                                    73020.0,
                                    80506.0,
                                    87403.0,
                                    95056.0,
                                    102912.0,
                                    99369.0,
                                    94603.0,
                                    93952.0,
                                    108888.0,
                                    119306.0,
                                    116007.0,
                                    110035.0,
                                    116634.0,
                                    118894.0,
                                    126216.0,
                                    126802.0,
                                    121801.0,
                                    118781.0,
                                    110979.0,
                                    103501.0,
                                    105617.0,
                                    105616.8828125,
                                ]
                            }
                        ],
                    },
                }
            ],
            "error": None,
        }
    }["chart"]["result"][0]

    quote = response["indicators"]["quote"][0]
    timestamp = response["timestamp"][:-1]
    entries = []

    for i in range(len(timestamp)):

        date = datetime.fromtimestamp(timestamp[i])
        if date.day != 1:
            date = datetime(date.year, date.month, 1) + relativedelta(months=1)
        data = B3CotaHistData()
        data.load_essentials(
            "IBOVESPA",
            date.strftime("%Y%m%d"),
            "Indice Ibovespa",
            Decimal(quote["open"][i]).quantize(Decimal("0.01")),
            Decimal(quote["close"][i]).quantize(Decimal("0.01")),
            None,
            Decimal(quote["high"][i]).quantize(Decimal("0.01")),
            Decimal(quote["low"][i]).quantize(Decimal("0.01")),
            None,
            None,
            Decimal(quote["volume"][i]).quantize(Decimal("0.01")),
            None,
        )
        entries.append(data)

    CotaHistRepository().batch_save(entries)
